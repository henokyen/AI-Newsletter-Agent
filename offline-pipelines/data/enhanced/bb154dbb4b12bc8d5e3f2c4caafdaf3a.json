{
    "id": "bb154dbb4b12bc8d5e3f2c4caafdaf3a",
    "metadata": {
        "id": "bb154dbb4b12bc8d5e3f2c4caafdaf3a",
        "url": "https://github.com/NVIDIA/Megatron-LM/",
        "title": "GitHub - NVIDIA/Megatron-LM: Ongoing research training transformer models at scale",
        "properties": {
            "description": "Ongoing research training transformer models at scale - NVIDIA/Megatron-LM",
            "keywords": null,
            "author": null,
            "og:image": "https://opengraph.githubassets.com/232aee1e44cdbb6976c4e2de270092a5c985950c7a850607eb18104daebe20f1/NVIDIA/Megatron-LM",
            "og:image:alt": "Ongoing research training transformer models at scale - NVIDIA/Megatron-LM",
            "og:image:width": "1200",
            "og:image:height": "600",
            "og:site_name": "GitHub",
            "og:type": "object",
            "og:title": "GitHub - NVIDIA/Megatron-LM: Ongoing research training transformer models at scale",
            "og:url": "https://github.com/NVIDIA/Megatron-LM",
            "og:description": "Ongoing research training transformer models at scale - NVIDIA/Megatron-LM",
            "twitter:image": "https://opengraph.githubassets.com/232aee1e44cdbb6976c4e2de270092a5c985950c7a850607eb18104daebe20f1/NVIDIA/Megatron-LM",
            "twitter:site": "@github",
            "twitter:card": "summary_large_image",
            "twitter:title": "GitHub - NVIDIA/Megatron-LM: Ongoing research training transformer models at scale",
            "twitter:description": "Ongoing research training transformer models at scale - NVIDIA/Megatron-LM"
        }
    },
    "parent_metadata": {
        "id": "eff9dda8e0a6dfc9a5cf451d7cbd793b",
        "url": "https://www.notion.so/Multi-GPU-Distributed-Training-eff9dda8e0a6dfc9a5cf451d7cbd793b",
        "title": "Multi-GPU / Distributed Training",
        "properties": {
            "Type": "Leaf"
        }
    },
    "content": "[Skip to content](https://github.com/NVIDIA/Megatron-LM/#start-of-content)\n## Navigation Menu\nToggle navigation\n[ ](https://github.com/)\n[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2FNVIDIA%2FMegatron-LM%2F)\n  * Product \n    * [ GitHub Copilot Write better code with AI  ](https://github.com/features/copilot)\n    * [ Security Find and fix vulnerabilities  ](https://github.com/features/security)\n    * [ Actions Automate any workflow  ](https://github.com/features/actions)\n    * [ Codespaces Instant dev environments  ](https://github.com/features/codespaces)\n    * [ Issues Plan and track work  ](https://github.com/features/issues)\n    * [ Code Review Manage code changes  ](https://github.com/features/code-review)\n    * [ Discussions Collaborate outside of code  ](https://github.com/features/discussions)\n    * [ Code Search Find more, search less  ](https://github.com/features/code-search)\nExplore\n    * [ All features ](https://github.com/features)\n    * [ Documentation ](https://docs.github.com)\n    * [ GitHub Skills ](https://skills.github.com)\n    * [ Blog ](https://github.blog)\n  * Solutions \nBy company size\n    * [ Enterprises ](https://github.com/enterprise)\n    * [ Small and medium teams ](https://github.com/team)\n    * [ Startups ](https://github.com/enterprise/startups)\n    * [ Nonprofits ](https://github.com/solutions/industry/nonprofits)\nBy use case\n    * [ DevSecOps ](https://github.com/solutions/use-case/devsecops)\n    * [ DevOps ](https://github.com/solutions/use-case/devops)\n    * [ CI/CD ](https://github.com/solutions/use-case/ci-cd)\n    * [ View all use cases ](https://github.com/solutions/use-case)\nBy industry\n    * [ Healthcare ](https://github.com/solutions/industry/healthcare)\n    * [ Financial services ](https://github.com/solutions/industry/financial-services)\n    * [ Manufacturing ](https://github.com/solutions/industry/manufacturing)\n    * [ Government ](https://github.com/solutions/industry/government)\n    * [ View all industries ](https://github.com/solutions/industry)\n[ View all solutions ](https://github.com/solutions)\n  * Resources \nTopics\n    * [ AI ](https://github.com/resources/articles/ai)\n    * [ DevOps ](https://github.com/resources/articles/devops)\n    * [ Security ](https://github.com/resources/articles/security)\n    * [ Software Development ](https://github.com/resources/articles/software-development)\n    * [ View all ](https://github.com/resources/articles)\nExplore\n    * [ Learning Pathways ](https://resources.github.com/learn/pathways)\n    * [ Events & Webinars ](https://resources.github.com)\n    * [ Ebooks & Whitepapers ](https://github.com/resources/whitepapers)\n    * [ Customer Stories ](https://github.com/customer-stories)\n    * [ Partners ](https://partner.github.com)\n    * [ Executive Insights ](https://github.com/solutions/executive-insights)\n  * Open Source \n    * [ GitHub Sponsors Fund open source developers  ](https://github.com/sponsors)\n    * [ The ReadME Project GitHub community articles  ](https://github.com/readme)\nRepositories\n    * [ Topics ](https://github.com/topics)\n    * [ Trending ](https://github.com/trending)\n    * [ Collections ](https://github.com/collections)\n  * Enterprise \n    * [ Enterprise platform AI-powered developer platform  ](https://github.com/enterprise)\nAvailable add-ons\n    * [ Advanced Security Enterprise-grade security features  ](https://github.com/enterprise/advanced-security)\n    * [ Copilot for business Enterprise-grade AI features  ](https://github.com/features/copilot/copilot-business)\n    * [ Premium Support Enterprise-grade 24/7 support  ](https://github.com/premium-support)\n  * [Pricing](https://github.com/pricing)\n\n\nSearch or jump to...\n# Search code, repositories, users, issues, pull requests...\nSearch \nClear\n[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)\n#  Provide feedback \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\nCancel  Submit feedback \n#  Saved searches \n## Use saved searches to filter your results more quickly\nName\nQuery\nTo see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). \nCancel  Create saved search \n[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2FNVIDIA%2FMegatron-LM%2F)\n[ Sign up ](https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=NVIDIA%2FMegatron-LM) Reseting focus\nYou signed in with another tab or window. [Reload](https://github.com/NVIDIA/Megatron-LM/) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/NVIDIA/Megatron-LM/) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/NVIDIA/Megatron-LM/) to refresh your session. Dismiss alert\n{{ message }}\n[ NVIDIA ](https://github.com/NVIDIA) / **[Megatron-LM](https://github.com/NVIDIA/Megatron-LM) ** Public\n  * [ Notifications ](https://github.com/login?return_to=%2FNVIDIA%2FMegatron-LM) You must be signed in to change notification settings\n  * [ Fork 2.7k ](https://github.com/login?return_to=%2FNVIDIA%2FMegatron-LM)\n  * [ Star  11.9k ](https://github.com/login?return_to=%2FNVIDIA%2FMegatron-LM)\n\n\nOngoing research training transformer models at scale \n[docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start](https://docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start \"https://docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start\")\n### License\n[ View license ](https://github.com/NVIDIA/Megatron-LM/blob/main/LICENSE)\n[ 11.9k stars ](https://github.com/NVIDIA/Megatron-LM/stargazers) [ 2.7k forks ](https://github.com/NVIDIA/Megatron-LM/forks) [ Branches ](https://github.com/NVIDIA/Megatron-LM/branches) [ Tags ](https://github.com/NVIDIA/Megatron-LM/tags) [ Activity ](https://github.com/NVIDIA/Megatron-LM/activity)\n[ Star  ](https://github.com/login?return_to=%2FNVIDIA%2FMegatron-LM)\n[ Notifications ](https://github.com/login?return_to=%2FNVIDIA%2FMegatron-LM) You must be signed in to change notification settings\n  * [ Code ](https://github.com/NVIDIA/Megatron-LM)\n  * [ Issues 246 ](https://github.com/NVIDIA/Megatron-LM/issues)\n  * [ Pull requests 177 ](https://github.com/NVIDIA/Megatron-LM/pulls)\n  * [ Discussions ](https://github.com/NVIDIA/Megatron-LM/discussions)\n  * [ Actions ](https://github.com/NVIDIA/Megatron-LM/actions)\n  * [ Security ](https://github.com/NVIDIA/Megatron-LM/security)\n  * [ Insights ](https://github.com/NVIDIA/Megatron-LM/pulse)\n\n\nAdditional navigation options\n  * [ Code  ](https://github.com/NVIDIA/Megatron-LM)\n  * [ Issues  ](https://github.com/NVIDIA/Megatron-LM/issues)\n  * [ Pull requests  ](https://github.com/NVIDIA/Megatron-LM/pulls)\n  * [ Discussions  ](https://github.com/NVIDIA/Megatron-LM/discussions)\n  * [ Actions  ](https://github.com/NVIDIA/Megatron-LM/actions)\n  * [ Security  ](https://github.com/NVIDIA/Megatron-LM/security)\n  * [ Insights  ](https://github.com/NVIDIA/Megatron-LM/pulse)\n\n\n# NVIDIA/Megatron-LM\nmain\n[**21** Branches](https://github.com/NVIDIA/Megatron-LM/branches)[**19** Tags](https://github.com/NVIDIA/Megatron-LM/tags)\n[](https://github.com/NVIDIA/Megatron-LM/branches)[](https://github.com/NVIDIA/Megatron-LM/tags)\nGo to file\nCode\n## Folders and files\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n## Latest commit\n## History\n[6,060 Commits](https://github.com/NVIDIA/Megatron-LM/commits/main/)[](https://github.com/NVIDIA/Megatron-LM/commits/main/)  \n[.github](https://github.com/NVIDIA/Megatron-LM/tree/main/.github \".github\")| [.github](https://github.com/NVIDIA/Megatron-LM/tree/main/.github \".github\")  \n[.gitlab](https://github.com/NVIDIA/Megatron-LM/tree/main/.gitlab \".gitlab\")| [.gitlab](https://github.com/NVIDIA/Megatron-LM/tree/main/.gitlab \".gitlab\")  \n[docs](https://github.com/NVIDIA/Megatron-LM/tree/main/docs \"docs\")| [docs](https://github.com/NVIDIA/Megatron-LM/tree/main/docs \"docs\")  \n[examples](https://github.com/NVIDIA/Megatron-LM/tree/main/examples \"examples\")| [examples](https://github.com/NVIDIA/Megatron-LM/tree/main/examples \"examples\")  \n[images](https://github.com/NVIDIA/Megatron-LM/tree/main/images \"images\")| [images](https://github.com/NVIDIA/Megatron-LM/tree/main/images \"images\")  \n[megatron](https://github.com/NVIDIA/Megatron-LM/tree/main/megatron \"megatron\")| [megatron](https://github.com/NVIDIA/Megatron-LM/tree/main/megatron \"megatron\")  \n[requirements](https://github.com/NVIDIA/Megatron-LM/tree/main/requirements \"requirements\")| [requirements](https://github.com/NVIDIA/Megatron-LM/tree/main/requirements \"requirements\")  \n[tasks](https://github.com/NVIDIA/Megatron-LM/tree/main/tasks \"tasks\")| [tasks](https://github.com/NVIDIA/Megatron-LM/tree/main/tasks \"tasks\")  \n[tests](https://github.com/NVIDIA/Megatron-LM/tree/main/tests \"tests\")| [tests](https://github.com/NVIDIA/Megatron-LM/tree/main/tests \"tests\")  \n[tools](https://github.com/NVIDIA/Megatron-LM/tree/main/tools \"tools\")| [tools](https://github.com/NVIDIA/Megatron-LM/tree/main/tools \"tools\")  \n[.coveragerc](https://github.com/NVIDIA/Megatron-LM/blob/main/.coveragerc \".coveragerc\")| [.coveragerc](https://github.com/NVIDIA/Megatron-LM/blob/main/.coveragerc \".coveragerc\")  \n[.flake8](https://github.com/NVIDIA/Megatron-LM/blob/main/.flake8 \".flake8\")| [.flake8](https://github.com/NVIDIA/Megatron-LM/blob/main/.flake8 \".flake8\")  \n[.gitignore](https://github.com/NVIDIA/Megatron-LM/blob/main/.gitignore \".gitignore\")| [.gitignore](https://github.com/NVIDIA/Megatron-LM/blob/main/.gitignore \".gitignore\")  \n[.gitlab-ci.yml](https://github.com/NVIDIA/Megatron-LM/blob/main/.gitlab-ci.yml \".gitlab-ci.yml\")| [.gitlab-ci.yml](https://github.com/NVIDIA/Megatron-LM/blob/main/.gitlab-ci.yml \".gitlab-ci.yml\")  \n[.pylintrc](https://github.com/NVIDIA/Megatron-LM/blob/main/.pylintrc \".pylintrc\")| [.pylintrc](https://github.com/NVIDIA/Megatron-LM/blob/main/.pylintrc \".pylintrc\")  \n[CHANGELOG.md](https://github.com/NVIDIA/Megatron-LM/blob/main/CHANGELOG.md \"CHANGELOG.md\")| [CHANGELOG.md](https://github.com/NVIDIA/Megatron-LM/blob/main/CHANGELOG.md \"CHANGELOG.md\")  \n[CODEOWNERS](https://github.com/NVIDIA/Megatron-LM/blob/main/CODEOWNERS \"CODEOWNERS\")| [CODEOWNERS](https://github.com/NVIDIA/Megatron-LM/blob/main/CODEOWNERS \"CODEOWNERS\")  \n[CONTRIBUTING.md](https://github.com/NVIDIA/Megatron-LM/blob/main/CONTRIBUTING.md \"CONTRIBUTING.md\")| [CONTRIBUTING.md](https://github.com/NVIDIA/Megatron-LM/blob/main/CONTRIBUTING.md \"CONTRIBUTING.md\")  \n[Dockerfile.ci.dev](https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.ci.dev \"Dockerfile.ci.dev\")| [Dockerfile.ci.dev](https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.ci.dev \"Dockerfile.ci.dev\")  \n[Dockerfile.ci.lts](https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.ci.lts \"Dockerfile.ci.lts\")| [Dockerfile.ci.lts](https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.ci.lts \"Dockerfile.ci.lts\")  \n[Dockerfile.linting](https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.linting \"Dockerfile.linting\")| [Dockerfile.linting](https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.linting \"Dockerfile.linting\")  \n[LICENSE](https://github.com/NVIDIA/Megatron-LM/blob/main/LICENSE \"LICENSE\")| [LICENSE](https://github.com/NVIDIA/Megatron-LM/blob/main/LICENSE \"LICENSE\")  \n[MANIFEST.in](https://github.com/NVIDIA/Megatron-LM/blob/main/MANIFEST.in \"MANIFEST.in\")| [MANIFEST.in](https://github.com/NVIDIA/Megatron-LM/blob/main/MANIFEST.in \"MANIFEST.in\")  \n[README.md](https://github.com/NVIDIA/Megatron-LM/blob/main/README.md \"README.md\")| [README.md](https://github.com/NVIDIA/Megatron-LM/blob/main/README.md \"README.md\")  \n[mypy.ini](https://github.com/NVIDIA/Megatron-LM/blob/main/mypy.ini \"mypy.ini\")| [mypy.ini](https://github.com/NVIDIA/Megatron-LM/blob/main/mypy.ini \"mypy.ini\")  \n[pretrain_bert.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_bert.py \"pretrain_bert.py\")| [pretrain_bert.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_bert.py \"pretrain_bert.py\")  \n[pretrain_gpt.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_gpt.py \"pretrain_gpt.py\")| [pretrain_gpt.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_gpt.py \"pretrain_gpt.py\")  \n[pretrain_ict.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_ict.py \"pretrain_ict.py\")| [pretrain_ict.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_ict.py \"pretrain_ict.py\")  \n[pretrain_mamba.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_mamba.py \"pretrain_mamba.py\")| [pretrain_mamba.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_mamba.py \"pretrain_mamba.py\")  \n[pretrain_retro.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_retro.py \"pretrain_retro.py\")| [pretrain_retro.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_retro.py \"pretrain_retro.py\")  \n[pretrain_t5.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_t5.py \"pretrain_t5.py\")| [pretrain_t5.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_t5.py \"pretrain_t5.py\")  \n[pretrain_vision_classify.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_classify.py \"pretrain_vision_classify.py\")| [pretrain_vision_classify.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_classify.py \"pretrain_vision_classify.py\")  \n[pretrain_vision_dino.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_dino.py \"pretrain_vision_dino.py\")| [pretrain_vision_dino.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_dino.py \"pretrain_vision_dino.py\")  \n[pretrain_vision_inpaint.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_inpaint.py \"pretrain_vision_inpaint.py\")| [pretrain_vision_inpaint.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_inpaint.py \"pretrain_vision_inpaint.py\")  \n[pretrain_vlm.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vlm.py \"pretrain_vlm.py\")| [pretrain_vlm.py](https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vlm.py \"pretrain_vlm.py\")  \n[pyproject.toml](https://github.com/NVIDIA/Megatron-LM/blob/main/pyproject.toml \"pyproject.toml\")| [pyproject.toml](https://github.com/NVIDIA/Megatron-LM/blob/main/pyproject.toml \"pyproject.toml\")  \n[pytest.ini](https://github.com/NVIDIA/Megatron-LM/blob/main/pytest.ini \"pytest.ini\")| [pytest.ini](https://github.com/NVIDIA/Megatron-LM/blob/main/pytest.ini \"pytest.ini\")  \n[requirements_ci.txt](https://github.com/NVIDIA/Megatron-LM/blob/main/requirements_ci.txt \"requirements_ci.txt\")| [requirements_ci.txt](https://github.com/NVIDIA/Megatron-LM/blob/main/requirements_ci.txt \"requirements_ci.txt\")  \n[requirements_mlm.txt](https://github.com/NVIDIA/Megatron-LM/blob/main/requirements_mlm.txt \"requirements_mlm.txt\")| [requirements_mlm.txt](https://github.com/NVIDIA/Megatron-LM/blob/main/requirements_mlm.txt \"requirements_mlm.txt\")  \n[setup.py](https://github.com/NVIDIA/Megatron-LM/blob/main/setup.py \"setup.py\")| [setup.py](https://github.com/NVIDIA/Megatron-LM/blob/main/setup.py \"setup.py\")  \nView all files  \n## Repository files navigation\n  * [README](https://github.com/NVIDIA/Megatron-LM/)\n  * [License](https://github.com/NVIDIA/Megatron-LM/)\n\n\n# Megatron-LM & Megatron-Core\n[](https://github.com/NVIDIA/Megatron-LM/#megatron-lm--megatron-core)\n#### GPU optimized techniques for training transformer models at-scale\n[](https://github.com/NVIDIA/Megatron-LM/#gpu-optimized-techniques-for-training-transformer-models-at-scale)\n[![Documentation](https://camo.githubusercontent.com/c191e0610a0b83ed5bef19569b59b7f27f7da4b11c720841af9028c9f239bf97/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f646f63732d6c61746573742d627269676874677265656e2e7376673f7374796c653d666c6174)](https://docs.nvidia.com/megatron-core/developer-guide/latest/index.html) [![version](https://camo.githubusercontent.com/26522c07e6ed933bcfd6ee6199936d61a033775159a5bd77de15161c9ae5f80f/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f72656c656173652d302e352e302d677265656e)](https://github.com/NVIDIA/Megatron-LM/blob/main/setup.py) [![license](https://camo.githubusercontent.com/798d8b63d18bcf654e3f021461ec449c8e113afe49eeb8f16a197b0042d746ac/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4f70656e4253442d626c7565)](https://github.com/NVIDIA/Megatron-LM/blob/main/LICENSE)\n# Latest News\n[](https://github.com/NVIDIA/Megatron-LM/#latest-news)\n  * **[2024/7]** Megatron-Core v0.7 improves scalability and training resiliency and adds support for multimodal training ([blog](https://developer.nvidia.com/blog/train-generative-ai-models-more-efficiently-with-new-nvidia-megatron-core-functionalities/)).\n  * **[2024/6]** Megatron-Core added supports for Mamba-based models. Check out our paper [An Empirical Study of Mamba-based Language Models](https://arxiv.org/pdf/2406.07887) and [code example](https://github.com/NVIDIA/Megatron-LM/tree/ssm/examples/mamba).\n  * **[2024/1 Announcement]** NVIDIA has released the core capabilities in **Megatron-LM** into [**Megatron-Core**](https://github.com/NVIDIA/Megatron-LM/tree/main/megatron/core) in this repository. Megatron-Core expands upon Megatron-LM's GPU-optimized techniques with more cutting-edge innovations on system-level optimizations, featuring composable and modular APIs. Explore the [Megatron-Core intro](https://github.com/NVIDIA/Megatron-LM/#megatron-core) for more details.\n\n\n# Table of Contents\n[](https://github.com/NVIDIA/Megatron-LM/#table-of-contents)\n  * [Megatron-LM & Megatron-Core](https://github.com/NVIDIA/Megatron-LM/#megatron-lm--megatron-core)\n  * [Latest News](https://github.com/NVIDIA/Megatron-LM/#latest-news)\n  * [Table of Contents](https://github.com/NVIDIA/Megatron-LM/#table-of-contents)\n  * [Megatron Overview](https://github.com/NVIDIA/Megatron-LM/#megatron-overview)\n    * [Megatron-LM](https://github.com/NVIDIA/Megatron-LM/#megatron-lm)\n    * [Megatron-Core](https://github.com/NVIDIA/Megatron-LM/#megatron-core)\n  * [Training Speed and Scalability](https://github.com/NVIDIA/Megatron-LM/#training-speed-and-scalability)\n  * [Setup](https://github.com/NVIDIA/Megatron-LM/#setup)\n    * [Downloading Checkpoints](https://github.com/NVIDIA/Megatron-LM/#downloading-checkpoints)\n  * [Usage](https://github.com/NVIDIA/Megatron-LM/#usage)\n  * [Training](https://github.com/NVIDIA/Megatron-LM/#training)\n    * [Data Preprocessing](https://github.com/NVIDIA/Megatron-LM/#data-preprocessing)\n    * [BERT Pretraining](https://github.com/NVIDIA/Megatron-LM/#bert-pretraining)\n    * [GPT Pretraining](https://github.com/NVIDIA/Megatron-LM/#gpt-pretraining)\n    * [T5 Pretraining](https://github.com/NVIDIA/Megatron-LM/#t5-pretraining)\n    * [Distributed Pretraining](https://github.com/NVIDIA/Megatron-LM/#distributed-pretraining)\n    * [Activation Checkpointing and Recomputation](https://github.com/NVIDIA/Megatron-LM/#activation-checkpointing-and-recomputation)\n    * [Distributed Optimizer](https://github.com/NVIDIA/Megatron-LM/#distributed-optimizer)\n    * [FlashAttention](https://github.com/NVIDIA/Megatron-LM/#flashattention)\n    * [GPT-3 Example](https://github.com/NVIDIA/Megatron-LM/#gpt-3-example)\n    * [Retro and InstructRetro](https://github.com/NVIDIA/Megatron-LM/#retro-and-instructretro)\n    * [Mamba-based Language Models](https://github.com/NVIDIA/Megatron-LM/#mamba-based-language-models)\n    * [Mixture of Experts](https://github.com/NVIDIA/Megatron-LM/#mixture-of-experts)\n  * [Evaluation and Tasks](https://github.com/NVIDIA/Megatron-LM/#evaluation-and-tasks)\n    * [GPT Text Generation](https://github.com/NVIDIA/Megatron-LM/#gpt-text-generation)\n      * [Detoxify GPT via Self-generation](https://github.com/NVIDIA/Megatron-LM/#detoxify-gpt-via-self-generation)\n    * [GPT Evaluation](https://github.com/NVIDIA/Megatron-LM/#gpt-evaluation)\n      * [WikiText Perplexity Evaluation](https://github.com/NVIDIA/Megatron-LM/#wikitext-perplexity-evaluation)\n      * [LAMBADA Cloze Accuracy](https://github.com/NVIDIA/Megatron-LM/#lambada-cloze-accuracy)\n    * [BERT Task Evaluation](https://github.com/NVIDIA/Megatron-LM/#bert-task-evaluation)\n      * [RACE Evaluation](https://github.com/NVIDIA/Megatron-LM/#race-evaluation)\n      * [MNLI Evaluation](https://github.com/NVIDIA/Megatron-LM/#mnli-evaluation)\n    * [Llama-2 Inference and Finetuning](https://github.com/NVIDIA/Megatron-LM/#llama-2-inference-and-finetuning)\n  * [Model Optimization and Deployment](https://github.com/NVIDIA/Megatron-LM/#model-optimization-and-deployment)\n    * [Quantization and TensorRT-LLM Deployment](https://github.com/NVIDIA/Megatron-LM/#quantization-and-tensorrt-llm-deployment)\n  * [Datasets](https://github.com/NVIDIA/Megatron-LM/#datasets)\n    * [Collecting Wikipedia Training Data](https://github.com/NVIDIA/Megatron-LM/#collecting-wikipedia-training-data)\n    * [Collecting GPT Webtext Data](https://github.com/NVIDIA/Megatron-LM/#collecting-gpt-webtext-data)\n  * [Reproducibility](https://github.com/NVIDIA/Megatron-LM/#reproducibility)\n  * [Checkpoint conversion](https://github.com/NVIDIA/Megatron-LM/#checkpoint-conversion)\n    * [Model class conversion](https://github.com/NVIDIA/Megatron-LM/#model-class-conversion)\n    * [Checkpoint format conversion](https://github.com/NVIDIA/Megatron-LM/#checkpoint-format-conversion)\n  * [Projects Using Megatron](https://github.com/NVIDIA/Megatron-LM/#projects-using-megatron)\n\n\n# Megatron Overview\n[](https://github.com/NVIDIA/Megatron-LM/#megatron-overview)\nThis repository comprises two essential components: **Megatron-LM** and **Megatron-Core**. Megatron-LM serves as a research-oriented framework leveraging Megatron-Core for large language model (LLM) training. Megatron-Core, on the other hand, is a library of GPU optimized training techniques that comes with formal product support including versioned APIs and regular releases. You can use Megatron-Core alongside Megatron-LM or [Nvidia NeMo Framework](https://docs.nvidia.com/deeplearning/nemo/user-guide/docs/en/main/nlp/nemo_megatron/mcore_customization.html) for an end-to-end and cloud-native solution. Alternatively, you can integrate Megatron-Core's building blocks into your preferred training framework.\n## Megatron-LM\n[](https://github.com/NVIDIA/Megatron-LM/#megatron-lm)\nFirst introduced in 2019, Megatron ([1](https://arxiv.org/pdf/1909.08053.pdf), [2](https://arxiv.org/pdf/2104.04473.pdf), and [3](https://arxiv.org/pdf/2205.05198)) sparked a wave of innovation in the AI community, enabling researchers and developers to utilize the underpinnings of this library to further LLM advancements. Today, many of the most popular LLM developer frameworks have been inspired by and built directly leveraging the open-source Megatron-LM library, spurring a wave of foundation models and AI startups. Some of the most popular LLM frameworks built on top of Megatron-LM include [Colossal-AI](https://github.com/hpcaitech/ColossalAI), [HuggingFace Accelerate](https://github.com/huggingface/accelerate), and [NVIDIA NeMo Framework](https://www.nvidia.com/en-us/ai-data-science/generative-ai/nemo-framework/). A list of projects that have directly used Megatron can be found [here](https://github.com/NVIDIA/Megatron-LM/#projects-using-megatron).\n## Megatron-Core\n[](https://github.com/NVIDIA/Megatron-LM/#megatron-core)\nMegatron-Core is an open-source PyTorch-based library that contains GPU-optimized techniques and cutting-edge system-level optimizations. It abstracts them into composable and modular APIs, allowing full flexibility for developers and model researchers to train custom transformers at-scale on NVIDIA accelerated computing infrastructure. This library is compatible with all NVIDIA Tensor Core GPUs, including FP8 acceleration support for [NVIDIA Hopper architectures](https://www.nvidia.com/en-us/data-center/technologies/hopper-architecture/).\nMegatron-Core offers core building blocks such as attention mechanisms, transformer blocks and layers, normalization layers, and embedding techniques. Additional functionality like activation recomputation, distributed checkpointing is also natively built-in to the library. The building blocks and functionality are all GPU optimized, and can be built with advanced parallelization strategies for optimal training speed and stability on NVIDIA Accelerated Computing Infrastructure. Another key component of the Megatron-Core library includes advanced model parallelism techniques (tensor, sequence, pipeline, context, and MoE expert parallelism).\nMegatron-Core can be used with [NVIDIA NeMo](https://www.nvidia.com/en-us/ai-data-science/products/nemo/), an enterprise-grade AI platform. Alternatively, you can explore Megatron-Core with the native PyTorch training loop [here](https://github.com/NVIDIA/Megatron-LM/tree/main/examples). Visit [Megatron-Core documentation](https://docs.nvidia.com/megatron-core/developer-guide/latest/index.html) to learn more.\n# Training Speed and Scalability\n[](https://github.com/NVIDIA/Megatron-LM/#training-speed-and-scalability)\nOur codebase is capable of efficiently training large language models (i.e., models with hundreds of billions of parameters) with both model and data parallelism. To demonstrate how our software scales with multiple GPUs and model sizes, we consider GPT models ranging from 2 billion parameters to 462 billion parameters. All models use a vocabulary size of 131,072 and a sequence length of 4096. We vary hidden size, number of attention heads, and number of layers to arrive at a specific model size. As the model size increases, we also modestly increase batch size. Our experiments use up to 6144 [H100](https://www.nvidia.com/en-us/data-center/h100/) GPUs. We perform fine-grained overlapping of data-parallel (`--overlap-grad-reduce --overlap-param-gather`), tensor-parallel (`--tp-comm-overlap`) and pipeline-parallel communication (enabled by default) with computation to improve scalability. The reported throughputs are measured for end-to-end training and include all operations including data loading, optimizer steps, communication, and even logging. Note that we did not train these models to convergence.\n[![Model table](https://github.com/NVIDIA/Megatron-LM/raw/main/images/model_table.png)](https://github.com/NVIDIA/Megatron-LM/blob/main/images/model_table.png)\nOur weak scaled results show superlinear scaling (MFU increases from 41% for the smallest model considered to 47-48% for the largest models); this is because larger GEMMs have higher arithmetic intensity and are consequently more efficient to execute.\n[![Weak scaling](https://github.com/NVIDIA/Megatron-LM/raw/main/images/weak_scaling.png)](https://github.com/NVIDIA/Megatron-LM/blob/main/images/weak_scaling.png)\nWe also strong scaled the standard GPT-3 model (our version has slightly more than 175 billion parameters due to larger vocabulary size) from 96 H100 GPUs to 4608 GPUs, using the same batch size of 1152 sequences throughout. Communication becomes more exposed at larger scale, leading to a reduction in MFU from 47% to 42%.\n[![Strong scaling](https://github.com/NVIDIA/Megatron-LM/raw/main/images/strong_scaling.png)](https://github.com/NVIDIA/Megatron-LM/blob/main/images/strong_scaling.png)\n# Setup\n[](https://github.com/NVIDIA/Megatron-LM/#setup)\nWe strongly recommend using the latest release of [NGC's PyTorch container](https://ngc.nvidia.com/catalog/containers/nvidia:pytorch) with DGX nodes. If you can't use this for some reason, use the latest pytorch, cuda, nccl, and NVIDIA [APEX](https://github.com/NVIDIA/apex#quick-start) releases. Data preprocessing requires [NLTK](https://www.nltk.org/install.html), though this is not required for training, evaluation, or downstream tasks.\nYou can launch an instance of the PyTorch container and mount Megatron, your dataset, and checkpoints with the following Docker commands:\n```\ndocker pull nvcr.io/nvidia/pytorch:xx.xx-py3\ndocker run --gpus all -it --rm -v /path/to/megatron:/workspace/megatron -v /path/to/dataset:/workspace/dataset -v /path/to/checkpoints:/workspace/checkpoints nvcr.io/nvidia/pytorch:xx.xx-py3\n\n```\n\n## Downloading Checkpoints\n[](https://github.com/NVIDIA/Megatron-LM/#downloading-checkpoints)\nWe have provided pretrained [BERT-345M](https://ngc.nvidia.com/catalog/models/nvidia:megatron_bert_345m) and [GPT-345M](https://ngc.nvidia.com/catalog/models/nvidia:megatron_lm_345m) checkpoints to evaluate or for finetuning downstream tasks. To access these checkpoints, first [sign up](https://ngc.nvidia.com/signup) for and [setup](https://ngc.nvidia.com/setup/installers/cli) the NVIDIA GPU Cloud (NGC) Registry CLI. Further documentation for downloading models can be found in the [NGC documentation](https://docs.nvidia.com/dgx/ngc-registry-cli-user-guide/index.html#topic_6_4_1).\nAlternatively, you can directly download the checkpoints using:\n```\nBERT-345M-uncased: wget --content-disposition https://api.ngc.nvidia.com/v2/models/nvidia/megatron_bert_345m/versions/v0.1_uncased/zip -O megatron_bert_345m_v0.1_uncased.zip\nBERT-345M-cased: wget --content-disposition https://api.ngc.nvidia.com/v2/models/nvidia/megatron_bert_345m/versions/v0.1_cased/zip -O megatron_bert_345m_v0.1_cased.zip\nGPT-345M: wget --content-disposition https://api.ngc.nvidia.com/v2/models/nvidia/megatron_lm_345m/versions/v0.0/zip -O megatron_lm_345m_v0.0.zip\n\n```\n\nThe models require vocabulary files to run. The BERT WordPiece vocab file can be extracted from Google's pretrained BERT models: [uncased](https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-vocab.txt), [cased](https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-vocab.txt). The GPT [vocab file](https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json) and [merge table](https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt) can be downloaded directly.\n# Usage\n[](https://github.com/NVIDIA/Megatron-LM/#usage)\nAfter installation, there are several possible workflows. The most comprehensive is:\n  1. Data preprocessing\n  2. Pretraining\n  3. Finetuning (Optional for zero-shot tasks)\n  4. Downstream task evaluation or text generation\n\n\nHowever, steps 1 and 2 can be replaced by using one of the pretrained models mentioned above.\nWe've provided several scripts for pretraining both BERT and GPT in the [`examples`](https://github.com/NVIDIA/Megatron-LM/blob/main/examples) directory, as well as scripts for both zero-shot and fine-tuned downstream tasks including MNLI, RACE, WikiText103, and LAMBADA evaluation. There is also a script for GPT interactive text generation.\n# Training\n[](https://github.com/NVIDIA/Megatron-LM/#training)\n## Data Preprocessing\n[](https://github.com/NVIDIA/Megatron-LM/#data-preprocessing)\nThe training data requires preprocessing. First, place your training data in a loose json format, with one json containing a text sample per line. For example:\n```\n{\"src\": \"www.nvidia.com\", \"text\": \"The quick brown fox\", \"type\": \"Eng\", \"id\": \"0\", \"title\": \"First Part\"}\n{\"src\": \"The Internet\", \"text\": \"jumps over the lazy dog\", \"type\": \"Eng\", \"id\": \"42\", \"title\": \"Second Part\"}\n\n```\n\nThe name of the `text` field of the json can be changed by using the `--json-key` flag in [`preprocess_data.py`](https://github.com/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py) The other metadata are optional and are not used in training.\nThe loose json is then processed into a binary format for training. To convert the json into mmap format use `preprocess_data.py`. An example script to prepare data for BERT training is:\n```\npython tools/preprocess_data.py \\\n    --input my-corpus.json \\\n    --output-prefix my-bert \\\n    --vocab-file bert-vocab.txt \\\n    --tokenizer-type BertWordPieceLowerCase \\\n    --split-sentences\n\n```\n\nThe output will be two files named, in this case, `my-bert_text_sentence.bin` and `my-bert_text_sentence.idx`. The `--data-path` specified in later BERT training is the full path and new filename, but without the file extension.\nFor T5 use the same preprocessing as BERT, perhaps renaming it to:\n```\n    --output-prefix my-t5 \\\n\n```\n\nSome minor modifications are required for GPT data preprocessing, namely, the addition of a merge table, an end-of-document token, removal of sentence splitting, and a change to the tokenizer type:\n```\npython tools/preprocess_data.py \\\n    --input my-corpus.json \\\n    --output-prefix my-gpt2 \\\n    --vocab-file gpt2-vocab.json \\\n    --tokenizer-type GPT2BPETokenizer \\\n    --merge-file gpt2-merges.txt \\\n    --append-eod\n\n```\n\nHere the output files are named `my-gpt2_text_document.bin` and `my-gpt2_text_document.idx`. As before, in GPT training, use the longer name without the extension as `--data-path`.\nFurther command line arguments are described in the source file [`preprocess_data.py`](https://github.com/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py).\n## BERT Pretraining\n[](https://github.com/NVIDIA/Megatron-LM/#bert-pretraining)\nThe [`examples/bert/train_bert_340m_distributed.sh`](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/bert/train_bert_340m_distributed.sh) script runs single GPU 345M parameter BERT pretraining. Debugging is the primary use for single GPU training, as the code base and command line arguments are optimized for highly distributed training. Most of the arguments are fairly self-explanatory. By default, the learning rate decays linearly over the training iterations starting at `--lr` to a minimum set by `--min-lr` over `--lr-decay-iters` iterations. The fraction of training iterations used for warmup is set by `--lr-warmup-fraction`. While this is single GPU training, the batch size specified by `--micro-batch-size` is a single forward-backward path batch-size and the code will perform gradient accumulation steps until it reaches `global-batch-size` which is the batch size per iteration. The data is partitioned into a 949:50:1 ratio for training/validation/test sets (default is 969:30:1). This partitioning happens on the fly, but is consistent across runs with the same random seed (1234 by default, or specified manually with `--seed`). We use `train-iters` as the training iterations requested. Alternatively, one can provide `--train-samples` which is total number of samples to train on. If this option is present, then instead of providing `--lr-decay-iters`, one will need to provide `--lr-decay-samples`.\nThe logging, checkpoint-saving, and evaluation interval options are specified. Note that the `--data-path` now includes the additional `_text_sentence` suffix added in preprocessing, but does not include the file extensions.\nFurther command line arguments are described in the source file [`arguments.py`](https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/training/arguments.py).\nTo run `train_bert_340m_distributed.sh`, make any desired modifications including setting the environment variables for `CHECKPOINT_PATH`, `VOCAB_FILE`, and `DATA_PATH`. Make sure to set these variables to their paths in the container. Then launch the container with Megatron and necessary paths mounted (as explained in [Setup](https://github.com/NVIDIA/Megatron-LM/#setup)) and run the example script.\n## GPT Pretraining\n[](https://github.com/NVIDIA/Megatron-LM/#gpt-pretraining)\nThe `examples/gpt3/train_gpt3_175b_distributed.sh` script runs single GPU 345M parameter GPT pretraining. As mentioned above, single GPU training is primarily intended for debugging purposes, as the code is optimized for distributed training.\nIt follows largely the same format as the previous BERT script with a few notable differences: the tokenization scheme used is BPE (which requires a merge table and a `json` vocabulary file) instead of WordPiece, the model architecture allows for longer sequences (note that the max position embedding must be greater than or equal to the maximum sequence length), and the `--lr-decay-style` has been set to cosine decay. Note that the `--data-path` now includes the additional `_text_document` suffix added in preprocessing, but does not include the file extensions.\nFurther command line arguments are described in the source file [`arguments.py`](https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/training/arguments.py).\n`train_gpt3_175b_distributed.sh` can be launched the same way as described for BERT. Set the env vars and make any other modifications, launch the container with appropriate mounts, and run the script. More details in [`examples/gpt3/README.md`](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/gpt3/README.md)\n## T5 Pretraining\n[](https://github.com/NVIDIA/Megatron-LM/#t5-pretraining)\nVery similar to BERT and GPT, the `examples/t5/train_t5_220m_distributed.sh` script runs single GPU \"base\" (~220M parameter) T5 pretraining. The primary difference from BERT and GPT is the addition of the following arguments to accommodate the T5 architecture:\n  * `--kv-channels` sets the inner dimension of the \"key\" and \"value\" matrices of all attention mechanisms in the model. For BERT and GPT this defaults to the hidden size divided by the number of attention heads, but can be configured for T5.\n  * `--ffn-hidden-size` sets the hidden size in the feed-forward networks within a transformer layer. For BERT and GPT this defaults to 4 times the transformer hidden size, but can be configured for T5.\n  * `--encoder-seq-length` and `--decoder-seq-length` set the sequence length for the encoder and decoder separately.\n\n\nAll of the other arguments remain as they were for BERT and GPT pretraining. Run this example with the same steps described above for the other scripts.\nMore details in [`examples/t5/README.md`](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/t5/README.md)\n## Distributed Pretraining\n[](https://github.com/NVIDIA/Megatron-LM/#distributed-pretraining)\nThe `pretrain_{bert,gpt,t5}_distributed.sh` scripts use the PyTorch distributed launcher for distributed training. As such, multi-node training can be achieved by properly setting environment variables. See the official PyTorch [documentation](https://pytorch.org/docs/stable/elastic/run.html#launcher-api) for further description of these [environment variables](https://pytorch.org/docs/stable/distributed.html#environment-variable-initialization). By default, multi-node training uses the [nccl](https://developer.nvidia.com/nccl) distributed backend. A simple set of additional arguments and the use of the PyTorch distributed module with the `torchrun` elastic launcher (equivalent to `python -m torch.distributed.run`) are the only additional requirements to adopt distributed training. See any of `pretrain_{bert,gpt,t5}_distributed.sh` for more details.\nWe use two types of parallelism: data and model parallelism. Our data parallelism implementation is in `megatron/core/distributed`, and supports overlapping of the gradient reduction with the backward pass when the `--overlap-grad-reduce` command-line option is used.\nSecond, we developed a simple and efficient two-dimensional model-parallel approach. To use the first dimension, tensor model parallelism (splitting execution of a single transformer module over multiple GPUs, see Section 3 of [our paper](https://arxiv.org/pdf/1909.08053.pdf)), add the `--tensor-model-parallel-size` flag to specify the number of GPUs among which to split the model, along with the arguments passed to the distributed launcher as mentioned above. To use the second dimension, sequence parallelism, specify `--sequence-parallel`, which also requires tensor model parallelism to be enabled because it splits across the same GPUs (more details in Section 4.2.2 of [our paper](https://arxiv.org/pdf/2205.05198.pdf)).\nTo use pipeline model parallelism (sharding the transformer modules into stages with an equal number of transformer modules on each stage, and then pipelining execution by breaking the batch into smaller microbatches, see Section 2.2 of [our paper](https://arxiv.org/pdf/2104.04473.pdf)), use the `--pipeline-model-parallel-size` flag to specify the number of stages to split the model into (e.g., splitting a model with 24 transformer layers across 4 stages would mean each stage gets 6 transformer layers each).\nWe have examples of how to use these two different forms of model parallelism the example scripts ending in `distributed_with_mp.sh`.\nOther than these minor changes, the distributed training is identical to the training on a single GPU.\nThe interleaved pipelining schedule (more details in Section 2.2.2 of [our paper](https://arxiv.org/pdf/2104.04473.pdf)) can be enabled using the `--num-layers-per-virtual-pipeline-stage` argument, which controls the number of transformer layers in a virtual stage (by default with the non-interleaved schedule, each GPU will execute a single virtual stage with `NUM_LAYERS / PIPELINE_MP_SIZE` transformer layers). The total number of layers in the transformer model should be divisible by this argument value. Additionally, the number of microbatches in the pipeline (computed as `GLOBAL_BATCH_SIZE / (DATA_PARALLEL_SIZE * MICRO_BATCH_SIZE)`) should be divisible by the `PIPELINE_MP_SIZE` when using this schedule (this condition is checked in an assertion in the code). The interleaved schedule is not supported for pipelines with 2 stages (`PIPELINE_MP_SIZE=2`).\n## Activation Checkpointing and Recomputation\n[](https://github.com/NVIDIA/Megatron-LM/#activation-checkpointing-and-recomputation)\nTo reduce GPU memory usage when training a large model, we support various forms of activation checkpointing and recomputation. Instead of all activations being stored in memory to be used during backprop, as was traditionally the case in deep learning models, only activations at certain \"checkpoints\" in the model are retained (or stored) in memory, and the other activations are recomputed on-the-fly when needed for backprop. Note that this kind of checkpointing, _activation_ checkpointing, is very different from the checkpointing of model parameters and optimizer state, which is mentioned elsewhere.\nWe support two levels of recompute granularity: `selective` and `full`. Selective recomputation is the default and is recommended in almost all cases. This mode retains in memory the activations that take less memory storage space and are more expensive to recompute and recomputes the activations that take more memory storage space but are relatively inexpensive to recompute. See [our paper](https://arxiv.org/pdf/2205.05198) for details. You should find that this mode maximizes performance while minimizing the memory required to store activations. To enable selective activation recompute simply use `--recompute-activations`.\nFor cases where memory is very limited, `full` recompute saves just the inputs to a transformer layer, or a group, or block, of transformer layers, and recomputes everything else. To enable full activation recompute use `--recompute-granularity full`. When using `full` activation recompute, there are two methods: `uniform` and `block`, chosen using the `--recompute-method` argument.\n  * The `uniform` method uniformly divides the transformer layers into groups of layers (each group of size `--recompute-num-layers`) and stores the input activations of each group in memory. The baseline group size is 1 and, in this case, the input activation of each transformer layer is stored. When the GPU memory is insufficient, increasing the number of layers per group reduces the memory usage, enabling a bigger model to be trained. For example, when `--recompute-num-layers` is set to 4, only the input activation of each group of 4 transformer layers is stored.\n  * The `block` method recomputes the input activations of a specific number (given by `--recompute-num-layers`) of individual transformer layers per pipeline stage and stores the input activations of the remaining layers in the pipeline stage. Reducing `--recompute-num-layers` results in storing the input activations to more transformer layers, which reduces the activation recomputation required in the backprop, thus improving training performance while increasing memory usage. For example, when we specify 5 layers to recompute of 8 layers per pipeline stage, the input activations of only the first 5 transformer layers are recomputed in the backprop step while the input activations for the final 3 layers are stored. `--recompute-num-layers` can be incrementally increased until the amount of memory storage space required is just small enough to fit in the available memory, thereby both maximally utilizing memory and maximizing performance.\n\n\n## Distributed Optimizer\n[](https://github.com/NVIDIA/Megatron-LM/#distributed-optimizer)\nUsage: `--use-distributed-optimizer`. Compatible with all model and data types.\nThe distributed optimizer is a memory savings technique, whereby the optimizer state is evenly distributed across data parallel ranks (versus the traditional method of replicating the optimizer state across data parallel ranks). As described in [ZeRO: Memory Optimizations Toward Training Trillion Parameter Models](https://arxiv.org/abs/1910.02054), our implementation distributes all optimizer state that does not overlap with the model state. For example, when using fp16 model params, the distributed optimizer maintains its own separate copy of fp32 main params & grads, which are distributed across DP ranks. When using bf16 model params, however, the distributed optimizer's fp32 main grads are the same as the model's fp32 grads, and so the grads in this case are not distributed (although the fp32 main params are still distributed, as they are separate from the bf16 model params).\nTheoretical memory savings vary depending on the combination of the model's param dtype and grad dtype. In our implementation, the theoretical number of bytes per parameter is (where 'd' is the data parallel size):\nNon-distributed optim | Distributed optim  \n---|---  \nfp16 param, fp16 grads | 20 | 4 + 16/d  \nbf16 param, fp32 grads | 18 | 6 + 12/d  \nfp32 param, fp32 grads | 16 | 8 + 8/d  \nAs with regular data parallelism, overlapping of the gradient reduction (in this case, a reduce-scatter) with the backward pass can be facilitated using the `--overlap-grad-reduce` flag. Additionally, overlapping of the parameter all-gather can be overlapped with the forward pass using `--overlap-param-gather`.\n## FlashAttention\n[](https://github.com/NVIDIA/Megatron-LM/#flashattention)\nUsage: `--use-flash-attn`. Support attention head dimensions at most 128.\n[FlashAttention](https://github.com/HazyResearch/flash-attention) is a fast and memory-efficient algorithm to compute exact attention. It speeds up model training and reduces memory requirement.\nTo install FlashAttention:\n```\npip install flash-attn\n```\n\n## GPT-3 Example\n[](https://github.com/NVIDIA/Megatron-LM/#gpt-3-example)\nIn `examples/gpt3/train_gpt3_175b_distributed.sh` we have provided an example of how to configure Megatron to train [GPT-3](https://arxiv.org/abs/2005.14165) with 175 billion parameters on 1024 GPUs. The script is designed for [slurm](https://slurm.schedmd.com/documentation.html) with [pyxis](https://github.com/NVIDIA/pyxis) plugin but can be easily adopted to any other scheduler. It uses 8-way tensor parallelism and 16-way pipeline parallelism. With options `global-batch-size 1536` and `rampup-batch-size 16 16 5859375`, the training will start with global batch size 16 and linearly increase the global batch size to 1536 over 5,859,375 samples with incremental steps 16. The training dataset can be either a single set or a multiple datasets combined with a set of weights.\nWith full global batch size of 1536 on 1024 A100 GPUs, each iteration takes around 32 seconds resulting in 138 teraFLOPs per GPU which is 44% of the theoretical peak FLOPs.\n## Retro and InstructRetro\n[](https://github.com/NVIDIA/Megatron-LM/#retro-and-instructretro)\nRetro [(Borgeaud et al., 2022)](https://arxiv.org/abs/2112.04426) is an autoregressive decoder-only language model (LM) pretrained with retrieval-augmentation. Retro features practical scalability to support large-scale pretraining from scratch by retrieving from trillions of tokens. Pretraining with retrieval provides a more efficient storage mechanism of factual knowledge, when compared to storing factual knowledge implicitly within the network's parameters, thus largely reducing model parameters while achieving lower perplexity than standard GPT. Retro also provides the flexibility to update the knowledge stored in LMs [(Wang et al., 2023a)](https://arxiv.org/abs/2304.06762) by updating the retrieval database without training LMs again.\nInstructRetro [(Wang et al., 2023b)](https://arxiv.org/abs/2310.07713) further scales up the size of Retro to 48B, featuring the largest LLM pretrained with retrieval (as of December 2023). The obtained foundation model, Retro 48B, largely outperforms the GPT counterpart in terms of perplexity. With instruction tuning on Retro, InstructRetro demonstrates significant improvement over the instruction tuned GPT on downstream tasks in the zero-shot setting. Specifically, the average improvement of InstructRetro is 7% over its GPT counterpart across 8 short-form QA tasks, and 10% over GPT across 4 challenging long-form QA tasks. We also find that one can ablate the encoder from InstructRetro architecture and directly use the InstructRetro decoder backbone as GPT, while achieving comparable results.\nIn this repo, we provide an end-to-end reproduction guide to implement Retro and InstructRetro, covering\n  * **Retrieval database construction** , which supports billions or even trillions of tokens as a large-scale retrieval database.\n  * **Pretraining with retrieval** , which supports pretraining from scratch and pretraining from a pretrained GPT model (Retro-fitting).\n  * **Instruction tuning** , where we provide an open-source instruction tuning dataset and the training recipe for instruction tuning on Retro.\n  * **Downstream task evaluation** , where we provide the text generation and evaluation scripts for zero-shot question answering tasks.\n\n\nSee [tools/retro/README.md](https://github.com/NVIDIA/Megatron-LM/blob/main/tools/retro/README.md) for a detailed overview.\n## Mamba-based Language Models\n[](https://github.com/NVIDIA/Megatron-LM/#mamba-based-language-models)\nSee [examples/mamba](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/mamba) for details.\n## Mixture of Experts\n[](https://github.com/NVIDIA/Megatron-LM/#mixture-of-experts)\nMoE (Mixture of Experts) is a powerful LLM architecture implemented in the Megatron-Core framework, designed to enhance the efficiency and scalability of large language models. It leverages **Expert Parallelism** , allowing multiple experts to be distributed across different workers, where each worker processes distinct batches of training samples. This method significantly increases computational throughput, enabling models to achieve high performance metrics, such as 47% MFU during BF16 training for 8x7B on H100.\nKey Features of MoE:\n  * **Parallelism Techniques** : MoE combines various parallelism strategies, including Expert Parallelism, Data Parallelism, Tensor Parallelism, Sequence Paralleism, Pipeline Parallelism, and Context Parallelism. This combination allows for handling larger model variants effectively.\n  * **Router and Load Balancing** : The system employs advanced routing mechanisms like the Top-K router and utilizes load balancing algorithms to optimize token distribution among experts.\n  * **Performance Optimizations** : Techniques such as GroupedGEMM and FP8 training enhance the efficiency of MoE models, particularly when multiple experts are involved.\n  * **Token Dispatch Mechanism** : MoE supports both dropless and token drop strategies to manage token distribution effectively across experts.\n\n\nFor a comprehensive overview of MoE training configurations and optimizations, please refer to the detailed README located at [megatron/core/transformer/moe/README.md](https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/core/transformer/moe/README.md).\n# Evaluation and Tasks\n[](https://github.com/NVIDIA/Megatron-LM/#evaluation-and-tasks)\nWe provide several command line arguments, detailed in the scripts listed below, to handle various zero-shot and fine-tuned downstream tasks. However, you can also finetune your model from a pretrained checkpoint on other corpora as desired. To do so, simply add the `--finetune` flag and adjust the input files and training parameters within the original training script. The iteration count will be reset to zero, and the optimizer and internal state will be reinitialized. If the fine-tuning is interrupted for any reason, be sure to remove the `--finetune` flag before continuing, otherwise the training will start again from the beginning.\nBecause evaluation requires substantially less memory than training, it may be advantageous to merge a model trained in parallel for use on fewer GPUs in downstream tasks. The following script accomplishes this. This example reads in a GPT model with 4-way tensor and 4-way pipeline model parallelism and writes out a model with 2-way tensor and 2-way pipeline model parallelism.\n```\npython tools/checkpoint/convert.py \\\n    --model-type GPT \\\n    --load-dir checkpoints/gpt3_tp4_pp4 \\\n    --save-dir checkpoints/gpt3_tp2_pp2 \\\n    --target-tensor-parallel-size 2 \\\n    --target-pipeline-parallel-size 2\n\n```\n\nSeveral downstream tasks are described for both GPT and BERT models below. They can be run in distributed and model parallel modes with the same changes used in the training scripts.\n## GPT Text Generation\n[](https://github.com/NVIDIA/Megatron-LM/#gpt-text-generation)\nWe have included a simple REST server to use for text generation in `tools/run_text_generation_server.py`. You run it much like you would start a pretraining job, specifying an appropriate pretrained checkpoint. There are also few optional parameters: `temperature`, `top-k`and `top-p`. See `--help` or the source file for more information. See [examples/inference/run_text_generation_server_345M.sh](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/inference/run_text_generation_server_345M.sh) for an example of how to run the server.\nOnce the server is running you can use `tools/text_generation_cli.py` to query it, it takes one argument which is the host the server is running on.\n```\ntools/text_generation_cli.py localhost:5000\n\n```\n\nYou can also use CURL or any other tools to query the server directly:\n```\ncurl 'http://localhost:5000/api' -X 'PUT' -H 'Content-Type: application/json; charset=UTF-8' -d '{\"prompts\":[\"Hello world\"], \"tokens_to_generate\":1}'\n\n```\n\nSee [megatron/inference/text_generation_server.py](https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/inference/text_generation_server.py) for more API options.\n### Detoxify GPT via Self-generation\n[](https://github.com/NVIDIA/Megatron-LM/#detoxify-gpt-via-self-generation)\nWe include an example in `examples/academic_paper_scripts/detxoify_lm/` to detoxify language models by leveraging the generative power of language models.\nSee [examples/academic_paper_scripts/detxoify_lm/README.md](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/academic_paper_scripts/detxoify_lm/README.md) for step-by-step tutorials on how to perform domain-adaptive training and detoxify LM using self-generated corpus.\n## GPT Evaluation\n[](https://github.com/NVIDIA/Megatron-LM/#gpt-evaluation)\nWe include example scripts for GPT evaluation on WikiText perplexity evaluation and LAMBADA Cloze accuracy.\n### WikiText Perplexity Evaluation\n[](https://github.com/NVIDIA/Megatron-LM/#wikitext-perplexity-evaluation)\nFor even comparison with prior works, we evaluate perplexity on the word-level [WikiText-103 test dataset](https://s3.amazonaws.com/research.metamind.io/wikitext/wikitext-103-v1.zip), and appropriately compute perplexity given the change in tokens when using our subword tokenizer.\nWe use the following command to run WikiText-103 evaluation on a 345M parameter model.\n```\nTASK=\"WIKITEXT103\"\nVALID_DATA=<wikitext path>.txt\nVOCAB_FILE=gpt2-vocab.json\nMERGE_FILE=gpt2-merges.txt\nCHECKPOINT_PATH=checkpoints/gpt2_345m\nCOMMON_TASK_ARGS=\"--num-layers 24 \\\n         --hidden-size 1024 \\\n         --num-attention-heads 16 \\\n         --seq-length 1024 \\\n         --max-position-embeddings 1024 \\\n         --fp16 \\\n         --vocab-file $VOCAB_FILE\"\npython tasks/main.py \\\n    --task $TASK \\\n    $COMMON_TASK_ARGS \\\n    --valid-data $VALID_DATA \\\n    --tokenizer-type GPT2BPETokenizer \\\n    --merge-file $MERGE_FILE \\\n    --load $CHECKPOINT_PATH \\\n    --micro-batch-size 8 \\\n    --log-interval 10 \\\n    --no-load-optim \\\n    --no-load-rng\n\n```\n\n### LAMBADA Cloze Accuracy\n[](https://github.com/NVIDIA/Megatron-LM/#lambada-cloze-accuracy)\nTo compute LAMBADA cloze accuracy (the accuracy of predicting the last token given the preceding tokens) we utilize a detokenized, processed version of the [LAMBADA dataset](https://github.com/cybertronai/bflm/blob/master/lambada_test.jsonl).\nWe use the following command to run LAMBADA evaluation on a 345M parameter model. Note that the `--strict-lambada` flag should be used to require whole word matching. Ensure that `lambada` is part of the file path.\n```\nTASK=\"LAMBADA\"\nVALID_DATA=<lambada path>.json\nVOCAB_FILE=gpt2-vocab.json\nMERGE_FILE=gpt2-merges.txt\nCHECKPOINT_PATH=checkpoints/gpt2_345m\nCOMMON_TASK_ARGS=<same as those in WikiText Perplexity Evaluation[](https://github.com/NVIDIA/Megatron-LM/#wikitext-perplexity-evaluation) above>\npython tasks/main.py \\\n    --task $TASK \\\n    $COMMON_TASK_ARGS \\\n    --valid-data $VALID_DATA \\\n    --tokenizer-type GPT2BPETokenizer \\\n    --strict-lambada \\\n    --merge-file $MERGE_FILE \\\n    --load $CHECKPOINT_PATH \\\n    --micro-batch-size 8 \\\n    --log-interval 10 \\\n    --no-load-optim \\\n    --no-load-rng\n\n```\n\nFurther command line arguments are described in the source file [`main.py`](https://github.com/NVIDIA/Megatron-LM/blob/main/tasks/main.py)\n## BERT Task Evaluation\n[](https://github.com/NVIDIA/Megatron-LM/#bert-task-evaluation)\n### RACE Evaluation\n[](https://github.com/NVIDIA/Megatron-LM/#race-evaluation)\nThe following script finetunes the BERT model for evaluation on the [RACE dataset](http://www.cs.cmu.edu/~glai1/data/race/). The `TRAIN_DATA` and `VALID_DATA` directory contain the RACE dataset as separate `.txt` files. Note that for RACE, the batch size is the number of RACE query's to evaluate. Since each RACE query has four samples, the effective batch size passed through the model will be four times the batch size specified on the command line.\n```\nTRAIN_DATA=\"data/RACE/train/middle\"\nVALID_DATA=\"data/RACE/dev/middle \\\n      data/RACE/dev/high\"\nVOCAB_FILE=bert-vocab.txt\nPRETRAINED_CHECKPOINT=checkpoints/bert_345m\nCHECKPOINT_PATH=checkpoints/bert_345m_race\nCOMMON_TASK_ARGS=\"--num-layers 24 \\\n         --hidden-size 1024 \\\n         --num-attention-heads 16 \\\n         --seq-length 512 \\\n         --max-position-embeddings 512 \\\n         --fp16 \\\n         --vocab-file $VOCAB_FILE\"\nCOMMON_TASK_ARGS_EXT=\"--train-data $TRAIN_DATA \\\n           --valid-data $VALID_DATA \\\n           --pretrained-checkpoint $PRETRAINED_CHECKPOINT \\\n           --save-interval 10000 \\\n           --save $CHECKPOINT_PATH \\\n           --log-interval 100 \\\n           --eval-interval 1000 \\\n           --eval-iters 10 \\\n           --weight-decay 1.0e-1\"\npython tasks/main.py \\\n    --task RACE \\\n    $COMMON_TASK_ARGS \\\n    $COMMON_TASK_ARGS_EXT \\\n    --tokenizer-type BertWordPieceLowerCase \\\n    --epochs 3 \\\n    --micro-batch-size 4 \\\n    --lr 1.0e-5 \\\n    --lr-warmup-fraction 0.06\n\n```\n\n### MNLI Evaluation\n[](https://github.com/NVIDIA/Megatron-LM/#mnli-evaluation)\nThe following script finetunes the BERT model for evaluation with the [MultiNLI sentence pair corpus](https://www.nyu.edu/projects/bowman/multinli/). Because the matching tasks are quite similar, the script can be quickly tweaked to work with the [Quora Question Pairs](https://www.kaggle.com/quora/question-pairs-dataset) (QQP) dataset as well.\n```\nTRAIN_DATA=\"data/glue_data/MNLI/train.tsv\"\nVALID_DATA=\"data/glue_data/MNLI/dev_matched.tsv \\\n      data/glue_data/MNLI/dev_mismatched.tsv\"\nPRETRAINED_CHECKPOINT=checkpoints/bert_345m\nVOCAB_FILE=bert-vocab.txt\nCHECKPOINT_PATH=checkpoints/bert_345m_mnli\nCOMMON_TASK_ARGS=<same as those in RACE Evaluation[](https://github.com/NVIDIA/Megatron-LM/#race-evaluation) above>\nCOMMON_TASK_ARGS_EXT=<same as those in RACE Evaluation[](https://github.com/NVIDIA/Megatron-LM/#race-evaluation) above>\npython tasks/main.py \\\n    --task MNLI \\\n    $COMMON_TASK_ARGS \\\n    $COMMON_TASK_ARGS_EXT \\\n    --tokenizer-type BertWordPieceLowerCase \\\n    --epochs 5 \\\n    --micro-batch-size 8 \\\n    --lr 5.0e-5 \\\n    --lr-warmup-fraction 0.065\n\n```\n\n## Llama-2 Inference and Finetuning\n[](https://github.com/NVIDIA/Megatron-LM/#llama-2-inference-and-finetuning)\nThe Llama-2 [family of models](https://ai.meta.com/llama/) are an open-source set of pretrained & finetuned (for chat) models that have achieved strong results across a wide set of benchmarks. At the time of release, Llama-2 models achieved among the best results for open-source models, and were competitive with the closed-source GPT-3.5 model (see <https://arxiv.org/pdf/2307.09288.pdf>).\nThe Llama-2 checkpoints can be loaded into Megatron for inference and finetuning. See documentation [here](https://github.com/NVIDIA/Megatron-LM/blob/main/docs/llama_mistral.md).\n# Model Optimization and Deployment\n[](https://github.com/NVIDIA/Megatron-LM/#model-optimization-and-deployment)\nMegatron-Core (MCore) `GPTModel` family supports advanced quantization algorithms and high-performance inference through TensorRT-LLM.\n## Quantization and TensorRT-LLM Deployment\n[](https://github.com/NVIDIA/Megatron-LM/#quantization-and-tensorrt-llm-deployment)\nSee [Megatron Model Optimization and Deployment](https://github.com/NVIDIA/Megatron-LM/blob/main/examples/inference/quantization/README.md) for `llama2` and `nemotron3` examples.\n# Datasets\n[](https://github.com/NVIDIA/Megatron-LM/#datasets)\nWe do not host any datasets for GPT or BERT training, however, we detail their collection so that our results may be reproduced.\n## Collecting Wikipedia Training Data\n[](https://github.com/NVIDIA/Megatron-LM/#collecting-wikipedia-training-data)\nWe recommend following the Wikipedia data extraction process specified by Google research: \"the recommended pre-processing is to download [the latest dump](https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2), extract the text with [WikiExtractor.py](https://github.com/attardi/wikiextractor), and then apply any necessary cleanup to convert it into plain text.\"\nWe recommend using the `--json` argument when using WikiExtractor, which will dump the Wikipedia data into loose json format (one json object per line), making it more manageable on the file system and also readily consumable by our codebase. We recommend further preprocessing this json dataset with nltk punctuation standardization. For BERT training, use the `--split-sentences` flag to `preprocess_data.py` as described [above](https://github.com/NVIDIA/Megatron-LM/#data-preprocessing) to include sentence breaks in the produced index. If you'd like to use Wikipedia data for GPT training you should still clean it with nltk/spacy/ftfy, but do not use the `--split-sentences` flag.\n## Collecting GPT Webtext Data\n[](https://github.com/NVIDIA/Megatron-LM/#collecting-gpt-webtext-data)\nWe utilize the publicly available [OpenWebText](https://github.com/eukaryote31/openwebtext) library from [jcpeterson](https://github.com/jcpeterson/openwebtext) and [eukaryote31's](https://github.com/eukaryote31/openwebtext) work to download urls. We then filter, clean, and deduplicate all downloaded content according to the procedure described in our [openwebtext](https://github.com/NVIDIA/Megatron-LM/blob/main/tools/openwebtext) directory. For reddit URLs corresponding to content up to October 2018 we arrived at approximately 37GB of content.\n# Reproducibility\n[](https://github.com/NVIDIA/Megatron-LM/#reproducibility)\nMegatron training can be bitwise reproducible; to enable this mode use `--deterministic-mode`. This means that the same training config run twice in the same HW and SW environment should produce identical model checkpoints, losses and accuracy metric values (iteration time metrics may vary).\nThere are currently three known Megatron optimizations that break reproducibility whilst still producing almost identical training runs:\n  1. The specific NCCL algorithm that is used during an all-reduce (as specified by the environment variable `NCCL_ALGO`) is important. We have tested the following: `^NVLS`, `Tree`, `Ring`, `CollnetDirect`, `CollnetChain`. The code admits the use of `^NVLS`, which allows NCCL the choice of non-NVLS algorithms; its choice seems to be stable.\n  2. Flash attention is non-deterministic; do not use `--use-flash-attn`.\n  3. If using Transformer Engine, you must also set the environment variable `NVTE_ALLOW_NONDETERMINISTIC_ALGO=0`.\n\n\nIn addition, determinisim has only been verified in NGC PyTorch containers up to and newer than 23.12. If you observe nondeterminism in Megatron training under other circumstances please open an issue.\n# Checkpoint conversion\n[](https://github.com/NVIDIA/Megatron-LM/#checkpoint-conversion)\nWe support two forms of model conversion:\n  1. Model class conversion (i.e., the `GPTModel` in `model.legacy` vs. `model.core`)\n  2. Checkpoint format conversion (i.e., distributed vs. non-distributed checkpoint)\n\n\n## Model class conversion\n[](https://github.com/NVIDIA/Megatron-LM/#model-class-conversion)\nMegatron supports converting between different model classes, including internal model classes (we currently have the older `legacy` models, and the newer `core` models) and external model classes (such as Meta, Huggingface, Mistral, and Mixtral models). Additionally, during this conversion, one can update the parallel state of the model (i.e., changing tensor and pipeline model parallelism).\nWe provide the tool `tools/checkpoint/convert.py` to convert between model classes. Some important arguments include:\n  * `--model-type`: `GPT` or `BERT`\n  * `--loader`: format of the existing checkpoint. Supported formats include: \n    * `legacy`: our older model classes (under `megatron.legacy.model`)\n    * `core`: our newer model classes (under `megatron.core.models`)\n    * `llama_mistral`: for loading Llama and Mistral models (supports Meta and Huggingface formats)\n    * `mixtral_hf`: for loading Mixtral models (Huggingface only)\n  * `--load-dir`: directory for loading the existing checkpoint\n  * `--saver`: `legacy` or `core` (see descriptions under `--loader`)\n  * `--save-dir`: directory for saving the new checkpoint\n  * `--target-tensor-parallel-size`: new tensor model parallel size\n  * `--target-pipeline-parallel-size`: new pipeline model parallel size\n\n\nFor more argument details, please see the main script (`convert.py`), loader scripts (`loader_core.py`, `loader_legacy.py`, `loader_llama_mistral.py`, `loader_mixtral_hf.py`), or saver scripts (`saver_core.py`, `saver_legacy.py`).\nAn example command for converting a GPT model from the old format (`legacy`) to the new format (`core`) would look as follows:\n```\npython tools/checkpoint/convert.py \\\n>  --model-type GPT \\\n>  --loader legacy \\\n>  --load-dir ${LEGACY_FORMAT_DIR} \\\n>  --saver core \\\n>  --save-dir ${CORE_FORMAT_DIR} \\\n>  --target-tensor-parallel-size ${TP} \\\n>  --target-pipeline-parallel-size ${PP} \\\n\n```\n\nFor examples of converting Llama/Mistral models into Megatron, please see [here](https://github.com/NVIDIA/Megatron-LM/blob/main/docs/llama_mistral.md).\n## Checkpoint format conversion\n[](https://github.com/NVIDIA/Megatron-LM/#checkpoint-format-conversion)\nMegatron offers multiple checkpoint formats, including:\n  * `torch`: Basic checkpoint format with sequential read & writes, and is tied to a specific tensor/pipeline model parallel state (TP/PP states, respectively). (While a specific checkpoint is tied to a specific TP/PP state, a checkpoint can still be manually converted via the model class converter described above).\n  * `torch_dist`: Distributed checkpoint format, for fast parallel reads & writes, and also is parallel state agnostic (i.e., one can load the same checkpoint to different TP/PP setups).\n\n\nGenerally speaking, `torch_dist` is the more modern and recommended checkpoint format due to its speed. However, depending on the use case, it may be desirable to convert between these two formats. To do so, launch your _training_ script (e.g., via `pretrain_gpt.py`) as you normally would, but with two additional arguments:\n  * `--ckpt-convert-format ${FORMAT}`: `${FORMAT}` can be one of `torch` or `torch_dist`, as described above.\n  * `--ckpt-convert-save ${PATH_TO_SAVE_NEW_FORMAT}`: this path should be different than your existing `--load`/`--save` paths, to avoid overwriting the existing checkpoint. After converting, use this new path for your `--load`/`--save` paths.\n\n\nThe general idea of this checkpoint format converter is that it launches the model just as one normally would for training, but before running any training iterations, it saves to the new checkpoint format, and then exits. It is important to note that all other launch args should remain the same, in order for the system to understand the previous checkpoint format.\n# Projects Using Megatron\n[](https://github.com/NVIDIA/Megatron-LM/#projects-using-megatron)\nBelow are some of the projects where we have directly used Megatron:\n  * [BERT and GPT Studies Using Megatron](https://arxiv.org/pdf/1909.08053.pdf)\n  * [BioMegatron: Larger Biomedical Domain Language Model](https://www.aclweb.org/anthology/2020.emnlp-main.379.pdf)\n  * [End-to-End Training of Neural Retrievers for Open-Domain Question Answering](https://arxiv.org/abs/2101.00408)\n  * [Large Scale Multi-Actor Generative Dialog Modeling](https://www.aclweb.org/anthology/2020.acl-main.8.pdf)\n  * [Local Knowledge Powered Conversational Agents](https://arxiv.org/abs/2010.10150)\n  * [MEGATRON-CNTRL: Controllable Story Generation with External Knowledge Using Large-Scale Language Models](https://www.aclweb.org/anthology/2020.emnlp-main.226.pdf)\n  * [RACE Reading Comprehension Dataset Leaderboard](http://www.qizhexie.com/data/RACE_leaderboard.html)\n  * [Training Question Answering Models From Synthetic Data](https://www.aclweb.org/anthology/2020.emnlp-main.468.pdf)\n  * [Few-shot Instruction Prompts for Pretrained Language Models to Detect Social Biases](https://arxiv.org/abs/2112.07868)\n  * [Exploring the Limits of Domain-Adaptive Training for Detoxifying Large-Scale Language Models](https://arxiv.org/abs/2202.04173)\n  * [Using DeepSpeed and Megatron to Train Megatron-Turing NLG 530B, A Large-Scale Generative Language Model](https://arxiv.org/abs/2201.11990)\n  * [Multi-Stage Prompting for Knowledgeable Dialogue Generation](https://arxiv.org/abs/2203.08745)\n  * [Evaluating Parameter Efficient Learning for Generation](https://aclanthology.org/2022.emnlp-main.319.pdf)\n  * [Exploring the Limits of Domain-Adaptive Training for Detoxifying Large-Scale Language Models](https://arxiv.org/abs/2202.04173)\n  * [Shall We Pretrain Autoregressive Language Models with Retrieval? A Comprehensive Study](https://arxiv.org/abs/2304.06762)\n  * [InstructRetro: Instruction Tuning post Retrieval-Augmented Pretraining](https://arxiv.org/abs/2310.07713)\n  * [An Empirical Study of Mamba-based Language Models](https://arxiv.org/abs/2406.07887)\n\n\n## About\nOngoing research training transformer models at scale \n[docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start](https://docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start \"https://docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start\")\n### Topics\n[ transformers ](https://github.com/topics/transformers \"Topic: transformers\") [ model-para ](https://github.com/topics/model-para \"Topic: model-para\") [ large-language-models ](https://github.com/topics/large-language-models \"Topic: large-language-models\")\n### Resources\n[ Readme ](https://github.com/NVIDIA/Megatron-LM/#readme-ov-file)\n### License\n[ View license ](https://github.com/NVIDIA/Megatron-LM/#License-1-ov-file)\n[ Activity](https://github.com/NVIDIA/Megatron-LM/activity)\n[ Custom properties](https://github.com/NVIDIA/Megatron-LM/custom-properties)\n### Stars\n[ **11.9k** stars](https://github.com/NVIDIA/Megatron-LM/stargazers)\n### Watchers\n[ **168** watching](https://github.com/NVIDIA/Megatron-LM/watchers)\n### Forks\n[ **2.7k** forks](https://github.com/NVIDIA/Megatron-LM/forks)\n[ Report repository ](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FNVIDIA%2FMegatron-LM&report=NVIDIA+%28user%29)\n##  [Releases 14](https://github.com/NVIDIA/Megatron-LM/releases)\n[ NVIDIA Megatron Core 0.11.0 Latest  Mar 14, 2025 ](https://github.com/NVIDIA/Megatron-LM/releases/tag/v0.11.0)\n[+ 13 releases](https://github.com/NVIDIA/Megatron-LM/releases)\n##  [Packages 0](https://github.com/orgs/NVIDIA/packages?repo_name=Megatron-LM)\nNo packages published \n##  [Contributors 152](https://github.com/NVIDIA/Megatron-LM/graphs/contributors)\n  * [ ![@jaredcasper](https://avatars.githubusercontent.com/u/155158?s=64&v=4) ](https://github.com/jaredcasper)\n  * [ ![@ko3n1g](https://avatars.githubusercontent.com/u/16716991?s=64&v=4) ](https://github.com/ko3n1g)\n  * [ ![@lmcafee-nvidia](https://avatars.githubusercontent.com/u/85179052?s=64&v=4) ](https://github.com/lmcafee-nvidia)\n  * [ ![@shanmugamr1992](https://avatars.githubusercontent.com/u/111910568?s=64&v=4) ](https://github.com/shanmugamr1992)\n  * [ ![@shoeybi](https://avatars.githubusercontent.com/u/1205686?s=64&v=4) ](https://github.com/shoeybi)\n  * [ ![@ericharper](https://avatars.githubusercontent.com/u/11999610?s=64&v=4) ](https://github.com/ericharper)\n  * [ ![@deepakn94](https://avatars.githubusercontent.com/u/2724038?s=64&v=4) ](https://github.com/deepakn94)\n  * [ ![@mikolajblaz](https://avatars.githubusercontent.com/u/9979479?s=64&v=4) ](https://github.com/mikolajblaz)\n  * [ ![@jon-barker](https://avatars.githubusercontent.com/u/19699370?s=64&v=4) ](https://github.com/jon-barker)\n  * [ ![@mpatwary](https://avatars.githubusercontent.com/u/4990625?s=64&v=4) ](https://github.com/mpatwary)\n  * [ ![@xrennvidia](https://avatars.githubusercontent.com/u/103958965?s=64&v=4) ](https://github.com/xrennvidia)\n  * [ ![@maanug-nv](https://avatars.githubusercontent.com/u/109391026?s=64&v=4) ](https://github.com/maanug-nv)\n  * [ ![@trintamaki](https://avatars.githubusercontent.com/u/143676174?s=64&v=4) ](https://github.com/trintamaki)\n  * [ ![@yanring](https://avatars.githubusercontent.com/u/12545681?s=64&v=4) ](https://github.com/yanring)\n\n\n[+ 138 contributors](https://github.com/NVIDIA/Megatron-LM/graphs/contributors)\n## Languages\n  * [ Python 99.1% ](https://github.com/NVIDIA/Megatron-LM/search?l=python)\n  * [ C++ 0.5% ](https://github.com/NVIDIA/Megatron-LM/search?l=c%2B%2B)\n  * [ Shell 0.3% ](https://github.com/NVIDIA/Megatron-LM/search?l=shell)\n  * [ C 0.1% ](https://github.com/NVIDIA/Megatron-LM/search?l=c)\n  * [ HTML 0.0% ](https://github.com/NVIDIA/Megatron-LM/search?l=html)\n  * [ Makefile 0.0% ](https://github.com/NVIDIA/Megatron-LM/search?l=makefile)\n\n\n## Footer\n[ ](https://github.com \"GitHub\")  2025 GitHub, Inc. \n### Footer navigation\n  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)\n  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)\n  * [Security](https://github.com/security)\n  * [Status](https://www.githubstatus.com/)\n  * [Docs](https://docs.github.com/)\n  * [Contact](https://support.github.com?tags=dotcom-footer)\n  * Manage cookies \n  * Do not share my personal information \n\n\nYou cant perform that action at this time. \n",
    "content_quality_score": 0.1,
    "summary": null,
    "child_urls": [
        "https://github.com/NVIDIA/Megatron-LM/#start-of-content",
        "https://github.com/",
        "https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2FNVIDIA%2FMegatron-LM%2F",
        "https://github.com/features/copilot",
        "https://github.com/features/security",
        "https://github.com/features/actions",
        "https://github.com/features/codespaces",
        "https://github.com/features/issues",
        "https://github.com/features/code-review",
        "https://github.com/features/discussions",
        "https://github.com/features/code-search",
        "https://github.com/features",
        "https://docs.github.com",
        "https://skills.github.com",
        "https://github.com/enterprise",
        "https://github.com/team",
        "https://github.com/enterprise/startups",
        "https://github.com/solutions/industry/nonprofits",
        "https://github.com/solutions/use-case/devsecops",
        "https://github.com/solutions/use-case/devops",
        "https://github.com/solutions/use-case/ci-cd",
        "https://github.com/solutions/use-case",
        "https://github.com/solutions/industry/healthcare",
        "https://github.com/solutions/industry/financial-services",
        "https://github.com/solutions/industry/manufacturing",
        "https://github.com/solutions/industry/government",
        "https://github.com/solutions/industry",
        "https://github.com/solutions",
        "https://github.com/resources/articles/ai",
        "https://github.com/resources/articles/devops",
        "https://github.com/resources/articles/security",
        "https://github.com/resources/articles/software-development",
        "https://github.com/resources/articles",
        "https://resources.github.com/learn/pathways",
        "https://resources.github.com",
        "https://github.com/resources/whitepapers",
        "https://github.com/customer-stories",
        "https://partner.github.com",
        "https://github.com/solutions/executive-insights",
        "https://github.com/sponsors",
        "https://github.com/readme",
        "https://github.com/topics",
        "https://github.com/trending",
        "https://github.com/collections",
        "https://github.com/enterprise/advanced-security",
        "https://github.com/features/copilot/copilot-business",
        "https://github.com/premium-support",
        "https://github.com/pricing",
        "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax",
        "https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=NVIDIA%2FMegatron-LM",
        "https://github.com/NVIDIA",
        "https://github.com/NVIDIA/Megatron-LM",
        "https://github.com/login?return_to=%2FNVIDIA%2FMegatron-LM",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/LICENSE",
        "https://github.com/NVIDIA/Megatron-LM/stargazers",
        "https://github.com/NVIDIA/Megatron-LM/forks",
        "https://github.com/NVIDIA/Megatron-LM/branches",
        "https://github.com/NVIDIA/Megatron-LM/tags",
        "https://github.com/NVIDIA/Megatron-LM/activity",
        "https://github.com/NVIDIA/Megatron-LM/issues",
        "https://github.com/NVIDIA/Megatron-LM/pulls",
        "https://github.com/NVIDIA/Megatron-LM/discussions",
        "https://github.com/NVIDIA/Megatron-LM/actions",
        "https://github.com/NVIDIA/Megatron-LM/security",
        "https://github.com/NVIDIA/Megatron-LM/pulse",
        "https://github.com/NVIDIA/Megatron-LM/commits/main/",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/.github",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/.gitlab",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/docs",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/examples",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/images",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/megatron",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/requirements",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/tasks",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/tests",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/tools",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/.coveragerc",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/.flake8",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/.gitignore",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/.gitlab-ci.yml",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/.pylintrc",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/CHANGELOG.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/CODEOWNERS",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/CONTRIBUTING.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.ci.dev",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.ci.lts",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/Dockerfile.linting",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/MANIFEST.in",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/README.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/mypy.ini",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_bert.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_gpt.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_ict.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_mamba.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_retro.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_t5.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_classify.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_dino.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vision_inpaint.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pretrain_vlm.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pyproject.toml",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/pytest.ini",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/requirements_ci.txt",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/requirements_mlm.txt",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/setup.py",
        "https://github.com/NVIDIA/Megatron-LM/",
        "https://github.com/NVIDIA/Megatron-LM/#megatron-lm--megatron-core",
        "https://github.com/NVIDIA/Megatron-LM/#gpu-optimized-techniques-for-training-transformer-models-at-scale",
        "https://github.com/NVIDIA/Megatron-LM/#latest-news",
        "https://github.com/NVIDIA/Megatron-LM/tree/ssm/examples/mamba",
        "https://github.com/NVIDIA/Megatron-LM/tree/main/megatron/core",
        "https://github.com/NVIDIA/Megatron-LM/#megatron-core",
        "https://github.com/NVIDIA/Megatron-LM/#table-of-contents",
        "https://github.com/NVIDIA/Megatron-LM/#megatron-overview",
        "https://github.com/NVIDIA/Megatron-LM/#megatron-lm",
        "https://github.com/NVIDIA/Megatron-LM/#training-speed-and-scalability",
        "https://github.com/NVIDIA/Megatron-LM/#setup",
        "https://github.com/NVIDIA/Megatron-LM/#downloading-checkpoints",
        "https://github.com/NVIDIA/Megatron-LM/#usage",
        "https://github.com/NVIDIA/Megatron-LM/#training",
        "https://github.com/NVIDIA/Megatron-LM/#data-preprocessing",
        "https://github.com/NVIDIA/Megatron-LM/#bert-pretraining",
        "https://github.com/NVIDIA/Megatron-LM/#gpt-pretraining",
        "https://github.com/NVIDIA/Megatron-LM/#t5-pretraining",
        "https://github.com/NVIDIA/Megatron-LM/#distributed-pretraining",
        "https://github.com/NVIDIA/Megatron-LM/#activation-checkpointing-and-recomputation",
        "https://github.com/NVIDIA/Megatron-LM/#distributed-optimizer",
        "https://github.com/NVIDIA/Megatron-LM/#flashattention",
        "https://github.com/NVIDIA/Megatron-LM/#gpt-3-example",
        "https://github.com/NVIDIA/Megatron-LM/#retro-and-instructretro",
        "https://github.com/NVIDIA/Megatron-LM/#mamba-based-language-models",
        "https://github.com/NVIDIA/Megatron-LM/#mixture-of-experts",
        "https://github.com/NVIDIA/Megatron-LM/#evaluation-and-tasks",
        "https://github.com/NVIDIA/Megatron-LM/#gpt-text-generation",
        "https://github.com/NVIDIA/Megatron-LM/#detoxify-gpt-via-self-generation",
        "https://github.com/NVIDIA/Megatron-LM/#gpt-evaluation",
        "https://github.com/NVIDIA/Megatron-LM/#wikitext-perplexity-evaluation",
        "https://github.com/NVIDIA/Megatron-LM/#lambada-cloze-accuracy",
        "https://github.com/NVIDIA/Megatron-LM/#bert-task-evaluation",
        "https://github.com/NVIDIA/Megatron-LM/#race-evaluation",
        "https://github.com/NVIDIA/Megatron-LM/#mnli-evaluation",
        "https://github.com/NVIDIA/Megatron-LM/#llama-2-inference-and-finetuning",
        "https://github.com/NVIDIA/Megatron-LM/#model-optimization-and-deployment",
        "https://github.com/NVIDIA/Megatron-LM/#quantization-and-tensorrt-llm-deployment",
        "https://github.com/NVIDIA/Megatron-LM/#datasets",
        "https://github.com/NVIDIA/Megatron-LM/#collecting-wikipedia-training-data",
        "https://github.com/NVIDIA/Megatron-LM/#collecting-gpt-webtext-data",
        "https://github.com/NVIDIA/Megatron-LM/#reproducibility",
        "https://github.com/NVIDIA/Megatron-LM/#checkpoint-conversion",
        "https://github.com/NVIDIA/Megatron-LM/#model-class-conversion",
        "https://github.com/NVIDIA/Megatron-LM/#checkpoint-format-conversion",
        "https://github.com/NVIDIA/Megatron-LM/#projects-using-megatron",
        "https://github.com/hpcaitech/ColossalAI",
        "https://github.com/huggingface/accelerate",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/images/model_table.png",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/images/weak_scaling.png",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/images/strong_scaling.png",
        "https://github.com/NVIDIA/apex#quick-start",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/tools/preprocess_data.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/bert/train_bert_340m_distributed.sh",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/training/arguments.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/gpt3/README.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/t5/README.md",
        "https://github.com/HazyResearch/flash-attention",
        "https://github.com/NVIDIA/pyxis",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/tools/retro/README.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/mamba",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/core/transformer/moe/README.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/inference/run_text_generation_server_345M.sh",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/megatron/inference/text_generation_server.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/academic_paper_scripts/detxoify_lm/README.md",
        "https://github.com/cybertronai/bflm/blob/master/lambada_test.jsonl",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/tasks/main.py",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/docs/llama_mistral.md",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/examples/inference/quantization/README.md",
        "https://github.com/attardi/wikiextractor",
        "https://github.com/eukaryote31/openwebtext",
        "https://github.com/jcpeterson/openwebtext",
        "https://github.com/NVIDIA/Megatron-LM/blob/main/tools/openwebtext",
        "https://github.com/topics/transformers",
        "https://github.com/topics/model-para",
        "https://github.com/topics/large-language-models",
        "https://github.com/NVIDIA/Megatron-LM/#readme-ov-file",
        "https://github.com/NVIDIA/Megatron-LM/#License-1-ov-file",
        "https://github.com/NVIDIA/Megatron-LM/custom-properties",
        "https://github.com/NVIDIA/Megatron-LM/watchers",
        "https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FNVIDIA%2FMegatron-LM&report=NVIDIA+%28user%29",
        "https://github.com/NVIDIA/Megatron-LM/releases",
        "https://github.com/NVIDIA/Megatron-LM/releases/tag/v0.11.0",
        "https://github.com/orgs/NVIDIA/packages?repo_name=Megatron-LM",
        "https://github.com/NVIDIA/Megatron-LM/graphs/contributors",
        "https://github.com/jaredcasper",
        "https://github.com/ko3n1g",
        "https://github.com/lmcafee-nvidia",
        "https://github.com/shanmugamr1992",
        "https://github.com/shoeybi",
        "https://github.com/ericharper",
        "https://github.com/deepakn94",
        "https://github.com/mikolajblaz",
        "https://github.com/jon-barker",
        "https://github.com/mpatwary",
        "https://github.com/xrennvidia",
        "https://github.com/maanug-nv",
        "https://github.com/trintamaki",
        "https://github.com/yanring",
        "https://github.com/NVIDIA/Megatron-LM/search?l=python",
        "https://github.com/NVIDIA/Megatron-LM/search?l=c%2B%2B",
        "https://github.com/NVIDIA/Megatron-LM/search?l=shell",
        "https://github.com/NVIDIA/Megatron-LM/search?l=c",
        "https://github.com/NVIDIA/Megatron-LM/search?l=html",
        "https://github.com/NVIDIA/Megatron-LM/search?l=makefile",
        "https://github.com",
        "https://docs.github.com/site-policy/github-terms/github-terms-of-service",
        "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement",
        "https://github.com/security",
        "https://docs.github.com/",
        "https://support.github.com?tags=dotcom-footer",
        "https://github.blog",
        "https://docs.nvidia.com/megatron-core/developer-guide/latest/user-guide/index.html#quick-start",
        "https://docs.nvidia.com/megatron-core/developer-guide/latest/index.html",
        "https://developer.nvidia.com/blog/train-generative-ai-models-more-efficiently-with-new-nvidia-megatron-core-functionalities/",
        "https://arxiv.org/pdf/2406.07887",
        "https://docs.nvidia.com/deeplearning/nemo/user-guide/docs/en/main/nlp/nemo_megatron/mcore_customization.html",
        "https://arxiv.org/pdf/1909.08053.pdf",
        "https://arxiv.org/pdf/2104.04473.pdf",
        "https://arxiv.org/pdf/2205.05198",
        "https://www.nvidia.com/en-us/ai-data-science/generative-ai/nemo-framework/",
        "https://www.nvidia.com/en-us/data-center/technologies/hopper-architecture/",
        "https://www.nvidia.com/en-us/ai-data-science/products/nemo/",
        "https://www.nvidia.com/en-us/data-center/h100/",
        "https://ngc.nvidia.com/catalog/containers/nvidia:pytorch",
        "https://www.nltk.org/install.html",
        "https://ngc.nvidia.com/catalog/models/nvidia:megatron_bert_345m",
        "https://ngc.nvidia.com/catalog/models/nvidia:megatron_lm_345m",
        "https://ngc.nvidia.com/signup",
        "https://ngc.nvidia.com/setup/installers/cli",
        "https://docs.nvidia.com/dgx/ngc-registry-cli-user-guide/index.html#topic_6_4_1",
        "https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-uncased-vocab.txt",
        "https://s3.amazonaws.com/models.huggingface.co/bert/bert-large-cased-vocab.txt",
        "https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-vocab.json",
        "https://s3.amazonaws.com/models.huggingface.co/bert/gpt2-merges.txt",
        "https://pytorch.org/docs/stable/elastic/run.html#launcher-api",
        "https://pytorch.org/docs/stable/distributed.html#environment-variable-initialization",
        "https://developer.nvidia.com/nccl",
        "https://arxiv.org/pdf/2205.05198.pdf",
        "https://arxiv.org/abs/1910.02054",
        "https://arxiv.org/abs/2005.14165",
        "https://slurm.schedmd.com/documentation.html",
        "https://arxiv.org/abs/2112.04426",
        "https://arxiv.org/abs/2304.06762",
        "https://arxiv.org/abs/2310.07713",
        "https://s3.amazonaws.com/research.metamind.io/wikitext/wikitext-103-v1.zip",
        "http://www.cs.cmu.edu/~glai1/data/race/",
        "https://www.nyu.edu/projects/bowman/multinli/",
        "https://www.kaggle.com/quora/question-pairs-dataset",
        "https://ai.meta.com/llama/",
        "https://arxiv.org/pdf/2307.09288.pdf",
        "https://dumps.wikimedia.org/enwiki/latest/enwiki-latest-pages-articles.xml.bz2",
        "https://www.aclweb.org/anthology/2020.emnlp-main.379.pdf",
        "https://arxiv.org/abs/2101.00408",
        "https://www.aclweb.org/anthology/2020.acl-main.8.pdf",
        "https://arxiv.org/abs/2010.10150",
        "https://www.aclweb.org/anthology/2020.emnlp-main.226.pdf",
        "http://www.qizhexie.com/data/RACE_leaderboard.html",
        "https://www.aclweb.org/anthology/2020.emnlp-main.468.pdf",
        "https://arxiv.org/abs/2112.07868",
        "https://arxiv.org/abs/2202.04173",
        "https://arxiv.org/abs/2201.11990",
        "https://arxiv.org/abs/2203.08745",
        "https://aclanthology.org/2022.emnlp-main.319.pdf",
        "https://arxiv.org/abs/2406.07887",
        "https://www.githubstatus.com/"
    ]
}