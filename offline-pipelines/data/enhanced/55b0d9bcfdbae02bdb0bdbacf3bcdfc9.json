{
    "id": "55b0d9bcfdbae02bdb0bdbacf3bcdfc9",
    "metadata": {
        "id": "55b0d9bcfdbae02bdb0bdbacf3bcdfc9",
        "url": "https://github.com/pytorch/PiPPy/",
        "title": "GitHub - pytorch/PiPPy: Pipeline Parallelism for PyTorch",
        "properties": {
            "description": "Pipeline Parallelism for PyTorch. Contribute to pytorch/PiPPy development by creating an account on GitHub.",
            "keywords": null,
            "author": null,
            "og:image": "https://opengraph.githubassets.com/4026109ff3ccbfe0cd9c8325d2ef63ca5816e0d6cb9adff1b53437c69483de5d/pytorch/PiPPy",
            "og:image:alt": "Pipeline Parallelism for PyTorch. Contribute to pytorch/PiPPy development by creating an account on GitHub.",
            "og:image:width": "1200",
            "og:image:height": "600",
            "og:site_name": "GitHub",
            "og:type": "object",
            "og:title": "GitHub - pytorch/PiPPy: Pipeline Parallelism for PyTorch",
            "og:url": "https://github.com/pytorch/PiPPy",
            "og:description": "Pipeline Parallelism for PyTorch. Contribute to pytorch/PiPPy development by creating an account on GitHub.",
            "twitter:image": "https://opengraph.githubassets.com/4026109ff3ccbfe0cd9c8325d2ef63ca5816e0d6cb9adff1b53437c69483de5d/pytorch/PiPPy",
            "twitter:site": "@github",
            "twitter:card": "summary_large_image",
            "twitter:title": "GitHub - pytorch/PiPPy: Pipeline Parallelism for PyTorch",
            "twitter:description": "Pipeline Parallelism for PyTorch. Contribute to pytorch/PiPPy development by creating an account on GitHub."
        }
    },
    "parent_metadata": {
        "id": "a312e4cb72931a8fef7c465ced182bbc",
        "url": "https://www.notion.so/Multi-GPU-Distributed-Training-a312e4cb72931a8fef7c465ced182bbc",
        "title": "Multi-GPU / Distributed Training",
        "properties": {
            "Type": "Leaf"
        }
    },
    "content": "[Skip to content](https://github.com/pytorch/PiPPy/#start-of-content)\n## Navigation Menu\nToggle navigation\n[ ](https://github.com/)\n[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fpytorch%2FPiPPy%2F)\n  * Product \n    * [ GitHub Copilot Write better code with AI  ](https://github.com/features/copilot)\n    * [ Security Find and fix vulnerabilities  ](https://github.com/features/security)\n    * [ Actions Automate any workflow  ](https://github.com/features/actions)\n    * [ Codespaces Instant dev environments  ](https://github.com/features/codespaces)\n    * [ Issues Plan and track work  ](https://github.com/features/issues)\n    * [ Code Review Manage code changes  ](https://github.com/features/code-review)\n    * [ Discussions Collaborate outside of code  ](https://github.com/features/discussions)\n    * [ Code Search Find more, search less  ](https://github.com/features/code-search)\nExplore\n    * [ All features ](https://github.com/features)\n    * [ Documentation ](https://docs.github.com)\n    * [ GitHub Skills ](https://skills.github.com)\n    * [ Blog ](https://github.blog)\n  * Solutions \nBy company size\n    * [ Enterprises ](https://github.com/enterprise)\n    * [ Small and medium teams ](https://github.com/team)\n    * [ Startups ](https://github.com/enterprise/startups)\n    * [ Nonprofits ](https://github.com/solutions/industry/nonprofits)\nBy use case\n    * [ DevSecOps ](https://github.com/solutions/use-case/devsecops)\n    * [ DevOps ](https://github.com/solutions/use-case/devops)\n    * [ CI/CD ](https://github.com/solutions/use-case/ci-cd)\n    * [ View all use cases ](https://github.com/solutions/use-case)\nBy industry\n    * [ Healthcare ](https://github.com/solutions/industry/healthcare)\n    * [ Financial services ](https://github.com/solutions/industry/financial-services)\n    * [ Manufacturing ](https://github.com/solutions/industry/manufacturing)\n    * [ Government ](https://github.com/solutions/industry/government)\n    * [ View all industries ](https://github.com/solutions/industry)\n[ View all solutions ](https://github.com/solutions)\n  * Resources \nTopics\n    * [ AI ](https://github.com/resources/articles/ai)\n    * [ DevOps ](https://github.com/resources/articles/devops)\n    * [ Security ](https://github.com/resources/articles/security)\n    * [ Software Development ](https://github.com/resources/articles/software-development)\n    * [ View all ](https://github.com/resources/articles)\nExplore\n    * [ Learning Pathways ](https://resources.github.com/learn/pathways)\n    * [ Events & Webinars ](https://resources.github.com)\n    * [ Ebooks & Whitepapers ](https://github.com/resources/whitepapers)\n    * [ Customer Stories ](https://github.com/customer-stories)\n    * [ Partners ](https://partner.github.com)\n    * [ Executive Insights ](https://github.com/solutions/executive-insights)\n  * Open Source \n    * [ GitHub Sponsors Fund open source developers  ](https://github.com/sponsors)\n    * [ The ReadME Project GitHub community articles  ](https://github.com/readme)\nRepositories\n    * [ Topics ](https://github.com/topics)\n    * [ Trending ](https://github.com/trending)\n    * [ Collections ](https://github.com/collections)\n  * Enterprise \n    * [ Enterprise platform AI-powered developer platform  ](https://github.com/enterprise)\nAvailable add-ons\n    * [ Advanced Security Enterprise-grade security features  ](https://github.com/enterprise/advanced-security)\n    * [ Copilot for business Enterprise-grade AI features  ](https://github.com/features/copilot/copilot-business)\n    * [ Premium Support Enterprise-grade 24/7 support  ](https://github.com/premium-support)\n  * [Pricing](https://github.com/pricing)\n\n\nSearch or jump to...\n# Search code, repositories, users, issues, pull requests...\nSearch \nClear\n[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)\n#  Provide feedback \nWe read every piece of feedback, and take your input very seriously.\nInclude my email address so I can be contacted\nCancel  Submit feedback \n#  Saved searches \n## Use saved searches to filter your results more quickly\nName\nQuery\nTo see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax). \nCancel  Create saved search \n[ Sign in ](https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fpytorch%2FPiPPy%2F)\n[ Sign up ](https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=pytorch%2FPiPPy) Reseting focus\nYou signed in with another tab or window. [Reload](https://github.com/pytorch/PiPPy/) to refresh your session. You signed out in another tab or window. [Reload](https://github.com/pytorch/PiPPy/) to refresh your session. You switched accounts on another tab or window. [Reload](https://github.com/pytorch/PiPPy/) to refresh your session. Dismiss alert\n{{ message }}\n[ pytorch ](https://github.com/pytorch) / **[PiPPy](https://github.com/pytorch/PiPPy) ** Public\n  * [ Notifications ](https://github.com/login?return_to=%2Fpytorch%2FPiPPy) You must be signed in to change notification settings\n  * [ Fork 87 ](https://github.com/login?return_to=%2Fpytorch%2FPiPPy)\n  * [ Star  760 ](https://github.com/login?return_to=%2Fpytorch%2FPiPPy)\n\n\nPipeline Parallelism for PyTorch \n### License\n[ BSD-3-Clause license ](https://github.com/pytorch/PiPPy/blob/main/LICENSE)\n[ 760 stars ](https://github.com/pytorch/PiPPy/stargazers) [ 87 forks ](https://github.com/pytorch/PiPPy/forks) [ Branches ](https://github.com/pytorch/PiPPy/branches) [ Tags ](https://github.com/pytorch/PiPPy/tags) [ Activity ](https://github.com/pytorch/PiPPy/activity)\n[ Star  ](https://github.com/login?return_to=%2Fpytorch%2FPiPPy)\n[ Notifications ](https://github.com/login?return_to=%2Fpytorch%2FPiPPy) You must be signed in to change notification settings\n  * [ Code ](https://github.com/pytorch/PiPPy)\n  * [ Issues 160 ](https://github.com/pytorch/PiPPy/issues)\n  * [ Pull requests 8 ](https://github.com/pytorch/PiPPy/pulls)\n  * [ Actions ](https://github.com/pytorch/PiPPy/actions)\n  * [ Projects 0 ](https://github.com/pytorch/PiPPy/projects)\n  * [ Security ](https://github.com/pytorch/PiPPy/security)\n  * [ Insights ](https://github.com/pytorch/PiPPy/pulse)\n\n\nAdditional navigation options\n  * [ Code  ](https://github.com/pytorch/PiPPy)\n  * [ Issues  ](https://github.com/pytorch/PiPPy/issues)\n  * [ Pull requests  ](https://github.com/pytorch/PiPPy/pulls)\n  * [ Actions  ](https://github.com/pytorch/PiPPy/actions)\n  * [ Projects  ](https://github.com/pytorch/PiPPy/projects)\n  * [ Security  ](https://github.com/pytorch/PiPPy/security)\n  * [ Insights  ](https://github.com/pytorch/PiPPy/pulse)\n\n\n# pytorch/PiPPy\nmain\n[Branches](https://github.com/pytorch/PiPPy/branches)[Tags](https://github.com/pytorch/PiPPy/tags)\n[](https://github.com/pytorch/PiPPy/branches)[](https://github.com/pytorch/PiPPy/tags)\nGo to file\nCode\n## Folders and files\nName| Name| Last commit message| Last commit date  \n---|---|---|---  \n## Latest commit\n## History\n[705 Commits](https://github.com/pytorch/PiPPy/commits/main/)[](https://github.com/pytorch/PiPPy/commits/main/)  \n[.github/workflows](https://github.com/pytorch/PiPPy/tree/main/.github/workflows \"This path skips through empty directories\")| [.github/workflows](https://github.com/pytorch/PiPPy/tree/main/.github/workflows \"This path skips through empty directories\")  \n[binaries](https://github.com/pytorch/PiPPy/tree/main/binaries \"binaries\")| [binaries](https://github.com/pytorch/PiPPy/tree/main/binaries \"binaries\")  \n[docs](https://github.com/pytorch/PiPPy/tree/main/docs \"docs\")| [docs](https://github.com/pytorch/PiPPy/tree/main/docs \"docs\")  \n[examples](https://github.com/pytorch/PiPPy/tree/main/examples \"examples\")| [examples](https://github.com/pytorch/PiPPy/tree/main/examples \"examples\")  \n[pippy](https://github.com/pytorch/PiPPy/tree/main/pippy \"pippy\")| [pippy](https://github.com/pytorch/PiPPy/tree/main/pippy \"pippy\")  \n[test](https://github.com/pytorch/PiPPy/tree/main/test \"test\")| [test](https://github.com/pytorch/PiPPy/tree/main/test \"test\")  \n[.coverage](https://github.com/pytorch/PiPPy/blob/main/.coverage \".coverage\")| [.coverage](https://github.com/pytorch/PiPPy/blob/main/.coverage \".coverage\")  \n[.flake8](https://github.com/pytorch/PiPPy/blob/main/.flake8 \".flake8\")| [.flake8](https://github.com/pytorch/PiPPy/blob/main/.flake8 \".flake8\")  \n[.gitignore](https://github.com/pytorch/PiPPy/blob/main/.gitignore \".gitignore\")| [.gitignore](https://github.com/pytorch/PiPPy/blob/main/.gitignore \".gitignore\")  \n[.gitmodules](https://github.com/pytorch/PiPPy/blob/main/.gitmodules \".gitmodules\")| [.gitmodules](https://github.com/pytorch/PiPPy/blob/main/.gitmodules \".gitmodules\")  \n[ARCHITECTURE.md](https://github.com/pytorch/PiPPy/blob/main/ARCHITECTURE.md \"ARCHITECTURE.md\")| [ARCHITECTURE.md](https://github.com/pytorch/PiPPy/blob/main/ARCHITECTURE.md \"ARCHITECTURE.md\")  \n[CITATION](https://github.com/pytorch/PiPPy/blob/main/CITATION \"CITATION\")| [CITATION](https://github.com/pytorch/PiPPy/blob/main/CITATION \"CITATION\")  \n[CODE_OF_CONDUCT.md](https://github.com/pytorch/PiPPy/blob/main/CODE_OF_CONDUCT.md \"CODE_OF_CONDUCT.md\")| [CODE_OF_CONDUCT.md](https://github.com/pytorch/PiPPy/blob/main/CODE_OF_CONDUCT.md \"CODE_OF_CONDUCT.md\")  \n[CONTRIBUTING.md](https://github.com/pytorch/PiPPy/blob/main/CONTRIBUTING.md \"CONTRIBUTING.md\")| [CONTRIBUTING.md](https://github.com/pytorch/PiPPy/blob/main/CONTRIBUTING.md \"CONTRIBUTING.md\")  \n[LICENSE](https://github.com/pytorch/PiPPy/blob/main/LICENSE \"LICENSE\")| [LICENSE](https://github.com/pytorch/PiPPy/blob/main/LICENSE \"LICENSE\")  \n[README.md](https://github.com/pytorch/PiPPy/blob/main/README.md \"README.md\")| [README.md](https://github.com/pytorch/PiPPy/blob/main/README.md \"README.md\")  \n[REFERENCE.md](https://github.com/pytorch/PiPPy/blob/main/REFERENCE.md \"REFERENCE.md\")| [REFERENCE.md](https://github.com/pytorch/PiPPy/blob/main/REFERENCE.md \"REFERENCE.md\")  \n[check.sh](https://github.com/pytorch/PiPPy/blob/main/check.sh \"check.sh\")| [check.sh](https://github.com/pytorch/PiPPy/blob/main/check.sh \"check.sh\")  \n[format.sh](https://github.com/pytorch/PiPPy/blob/main/format.sh \"format.sh\")| [format.sh](https://github.com/pytorch/PiPPy/blob/main/format.sh \"format.sh\")  \n[pyproject.toml](https://github.com/pytorch/PiPPy/blob/main/pyproject.toml \"pyproject.toml\")| [pyproject.toml](https://github.com/pytorch/PiPPy/blob/main/pyproject.toml \"pyproject.toml\")  \n[requirements.txt](https://github.com/pytorch/PiPPy/blob/main/requirements.txt \"requirements.txt\")| [requirements.txt](https://github.com/pytorch/PiPPy/blob/main/requirements.txt \"requirements.txt\")  \n[setup.py](https://github.com/pytorch/PiPPy/blob/main/setup.py \"setup.py\")| [setup.py](https://github.com/pytorch/PiPPy/blob/main/setup.py \"setup.py\")  \n[version.txt](https://github.com/pytorch/PiPPy/blob/main/version.txt \"version.txt\")| [version.txt](https://github.com/pytorch/PiPPy/blob/main/version.txt \"version.txt\")  \nView all files  \n## Repository files navigation\n  * [README](https://github.com/pytorch/PiPPy/)\n  * [Code of conduct](https://github.com/pytorch/PiPPy/)\n  * [BSD-3-Clause license](https://github.com/pytorch/PiPPy/)\n\n\n# PiPPy: Pipeline Parallelism for PyTorch\n[](https://github.com/pytorch/PiPPy/#pippy-pipeline-parallelism-for-pytorch)\nNote\nPiPPy has been migrated into [PyTorch](https://github.com/pytorch/pytorch) as a subpackage: [`torch.distributed.pipelining`](https://github.com/pytorch/pytorch/tree/main/torch/distributed/pipelining). You can find the detailed documentation [here](https://pytorch.org/docs/main/distributed.pipelining.html). The current repo mainly serves as a land of [examples](https://github.com/pytorch/PiPPy/blob/main/examples). The PiPPy library code will be removed. Please use the APIs in `torch.distributed.pipelining` instead. Thank you!\n[**Why PiPPy?**](https://github.com/pytorch/PiPPy/#why-pippy) | [**Install guide**](https://github.com/pytorch/PiPPy/#install) | [**Examples**](https://github.com/pytorch/PiPPy/#examples) | [**PiPPy Explained**](https://github.com/pytorch/PiPPy/#pippy-explained)\n# Why PiPPy?\n[](https://github.com/pytorch/PiPPy/#why-pippy)\nOne of the most important techniques for advancing the state of the art in deep learning is scaling. Common techniques for scaling neural networks include _data parallelism_ , _tensor/operation parallelism_ , and _pipeline parallelism_. In many cases, pipeline parallelism in particular can be an effective technique for scaling, however it is often difficult to implement, requiring intrusive code changes to model code and difficult-to-implement runtime orchestration code. PiPPy aims to provide a toolkit that does said things automatically to allow high-productivity scaling of models.\n# What is PiPPy?\n[](https://github.com/pytorch/PiPPy/#what-is-pippy)\nThe PiPPy project consists of a compiler and runtime stack for automated parallelism and scaling of PyTorch models. Currently, PiPPy focuses on _pipeline parallelism_ , a technique in which the code of the model is partitioned and multiple _micro-batches_ execute different parts of the model code concurrently. To learn more about pipeline parallelism, see [this article](https://www.deepspeed.ai/tutorials/pipeline/).\n[![pipeline_diagram_web](https://private-user-images.githubusercontent.com/6676466/317342803-c93e2fe7-1cd4-49a2-9fd8-231ec9905e0c.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDMzNTY5NDksIm5iZiI6MTc0MzM1NjY0OSwicGF0aCI6Ii82Njc2NDY2LzMxNzM0MjgwMy1jOTNlMmZlNy0xY2Q0LTQ5YTItOWZkOC0yMzFlYzk5MDVlMGMuanBnP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDMzMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAzMzBUMTc0NDA5WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YmJjMDNiM2VkYjg1MjA4NDc2NGI5MjU4NGU5YzFkZGU5MWIyNjhiZDVkMzU4MTZlZGViZWJmZWIzZWQxNDAxYSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.pw63-NJW05X45xuRlPCf9Od86_n_wh6SDe7pbgn-xPA)](https://private-user-images.githubusercontent.com/6676466/317342803-c93e2fe7-1cd4-49a2-9fd8-231ec9905e0c.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDMzNTY5NDksIm5iZiI6MTc0MzM1NjY0OSwicGF0aCI6Ii82Njc2NDY2LzMxNzM0MjgwMy1jOTNlMmZlNy0xY2Q0LTQ5YTItOWZkOC0yMzFlYzk5MDVlMGMuanBnP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDMzMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAzMzBUMTc0NDA5WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YmJjMDNiM2VkYjg1MjA4NDc2NGI5MjU4NGU5YzFkZGU5MWIyNjhiZDVkMzU4MTZlZGViZWJmZWIzZWQxNDAxYSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.pw63-NJW05X45xuRlPCf9Od86_n_wh6SDe7pbgn-xPA)\nFigure: Pipeline parallel. \"F\", \"B\" and \"U\" denote forward, backward and weight update, respectively. Different colors represent different micro-batches.\nPiPPy provides the following features that make pipeline parallelism easier:\n  * Automatic splitting of model code by tracing the model. The goal is for the user to provide model code as-is to the system for parallelization, without having to make heavyweight modifications to make parallelism work.\n  * Related to the last point, PiPPy supports non-trivial topologies, including skip connections and tied weights/layers. PiPPy provides configurable behavior for tied weights, allowing for transmission across pipeline stages or replication and gradient synchronization.\n  * First-class support for cross-host pipeline parallelism, as this is where PP is typically used (over slower interconnects). This is currently missing from the torchgpipe-based `torch.distributed.pipeline.sync.Pipe`.\n  * Composability with other parallelism schemes such as data parallelism or tensor splitting model parallelism (overall, known as \"3d parallelism\"). Currently, pipelining and data parallelism can be composed. Other compositions will be available in the future.\n  * Support for pipeline scheduling paradigms, including schedules like fill-drain (GPipe), 1F1B and interleaved 1F1B. More schedules will be added too.\n\n\nFor in-depth technical architecture, see [ARCHITECTURE.md](https://github.com/pytorch/PiPPy/blob/main/ARCHITECTURE.md).\n# Install\n[](https://github.com/pytorch/PiPPy/#install)\nPiPPy requires PyTorch version newer than 2.2.0.dev to work. To quickly install, for example, PyTorch nightly, run the following command from the same directory as this README:\n```\npip install -r requirements.txt --find-links https://download.pytorch.org/whl/nightly/cpu/torch_nightly.html\n\n```\n\nYou can also select the CUDA build of PyTorch if your system has NVIDIA GPUs, for example:\n```\npip install -r requirements.txt --find-links https://download.pytorch.org/whl/nightly/cu118/torch_nightly.html\n\n```\n\nTo install PiPPy from source, run the following command in the same directory as this README:\n```\npython setup.py install\n\n```\n\nTo expose PiPPy for development such that changes to this repo are reflected in the imported package, run:\n```\npython setup.py develop\n\n```\n\n# Examples\n[](https://github.com/pytorch/PiPPy/#examples)\nIn this repo, we provide rich examples based on realistic models. In particular, we show how to apply PiPPy without any code change to the model. Please refer to the [HuggingFace examples directory](https://github.com/pytorch/PiPPy/blob/main/examples/huggingface). Examples include: [BERT](https://github.com/pytorch/PiPPy/blob/main/examples/huggingface/pippy_bert.py), [GPT2](https://github.com/pytorch/PiPPy/blob/main/examples/huggingface/pippy_gpt2.py), [T5](https://github.com/pytorch/PiPPy/blob/main/examples/huggingface/pippy_t5.py), [LLaMA](https://github.com/pytorch/PiPPy/blob/main/examples/llama), etc.\n# PiPPy Explained\n[](https://github.com/pytorch/PiPPy/#pippy-explained)\nPiPPy consists of two parts: a _compiler_ and a _runtime_. The compiler takes your model code, splits it up, and transforms it into a `Pipe`, which is a wrapper that describes the model at each pipeline stage and their data-flow relationship. The runtime executes the `PipelineStage`s in parallel, handling things like micro-batch splitting, scheduling, communication, and gradient propagation, etc. We will cover the APIs for these concepts in this section.\n## Splitting a Model with Pipe\n[](https://github.com/pytorch/PiPPy/#splitting-a-model-with-pipe)\nTo see how we can split a model into a pipeline, let's first take an example trivial neural network:\n```\nimport torch\nclass MyNetworkBlock(torch.nn.Module):\n  def __init__(self, in_dim, out_dim):\n    super().__init__()\n    self.lin = torch.nn.Linear(in_dim, out_dim)\n  def forward(self, x):\n    x = self.lin(x)\n    x = torch.relu(x)\n    return x\n\nclass MyNetwork(torch.nn.Module):\n  def __init__(self, in_dim, layer_dims):\n    super().__init__()\n    prev_dim = in_dim\n    for i, dim in enumerate(layer_dims):\n      setattr(self, f'layer{i}', MyNetworkBlock(prev_dim, dim))\n      prev_dim = dim\n    self.num_layers = len(layer_dims)\n    # 10 output classes\n    self.output_proj = torch.nn.Linear(layer_dims[-1], 10)\n  def forward(self, x):\n    for i in range(self.num_layers):\n      x = getattr(self, f'layer{i}')(x)\n    return self.output_proj(x)\n\nin_dim = 512\nlayer_dims = [512, 1024, 256]\nmn = MyNetwork(in_dim, layer_dims).to(device)\n```\n\nThis network is written as free-form Python code; it has not been modified for any specific parallelism technique.\nLet us see our first usage of the `pippy.Pipe` interface:\n```\nfrom pippy import pipeline, annotate_split_points, Pipe, SplitPoint\nannotate_split_points(mn, {'layer0': SplitPoint.END,\n              'layer1': SplitPoint.END})\nbatch_size = 32\nexample_input = torch.randn(batch_size, in_dim, device=device)\nchunks = 4\npipe = pipeline(mn, chunks, example_args=(example_input,))\nprint(pipe)\n\"\"\"\n************************************* pipe *************************************\nGraphModule(\n (submod_0): PipeStageModule(\n  (L__self___layer0_mod_lin): Linear(in_features=512, out_features=512, bias=True)\n )\n (submod_1): PipeStageModule(\n  (L__self___layer1_mod_lin): Linear(in_features=512, out_features=1024, bias=True)\n )\n (submod_2): PipeStageModule(\n  (L__self___layer2_lin): Linear(in_features=1024, out_features=256, bias=True)\n  (L__self___output_proj): Linear(in_features=256, out_features=10, bias=True)\n )\n)\ndef forward(self, arg0):\n  submod_0 = self.submod_0(arg0); arg0 = None\n  submod_1 = self.submod_1(submod_0); submod_0 = None\n  submod_2 = self.submod_2(submod_1); submod_1 = None\n  return [submod_2]\n\"\"\"\n```\n\nSo what's going on here? First, `pipeline` turns our model into a directed acyclic graph (DAG) by tracing the model. Then, it groups together the operations and parameters into _pipeline stages_. Stages are represented as `submod_N` submodules, where `N` is a natural number.\nWe used `annotate_split_points` to specify that the code should be split and the end of `layer0` and `layer1`. Our code has thus been split into _three_ pipeline stages. PiPPy also provides `SplitPoint.BEGINNING` if a user wants to split before certain annotation point.\nWhile the `annotate_split_points` API gives users a way to specify the split points without modifying the model, PiPPy also provides an API for in-model annotation: `pipe_split()`. For details, you can read [this example](https://github.com/pytorch/PiPPy/blob/main/test/test_pipe.py).\nThis covers the basic usage of the `Pipe` API. For more information, see the documentation.\n## Using PipelineStage for Pipelined Execution\n[](https://github.com/pytorch/PiPPy/#using-pipelinestage-for-pipelined-execution)\nGiven the above `Pipe` object, we can use one of the `PipelineStage` classes to execute our model in a pipelined fashion. First off, let us instantiate a `PipelineStage` instance:\n```\n# We are using `torchrun` to run this example with multiple processes.\n# `torchrun` defines two environment variables: `RANK` and `WORLD_SIZE`.\nrank = int(os.environ[\"RANK\"])\nworld_size = int(os.environ[\"WORLD_SIZE\"])\n# Initialize distributed environment\nimport torch.distributed as dist\ndist.init_process_group(rank=rank, world_size=world_size)\n# Pipeline stage is our main pipeline runtime. It takes in the pipe object,\n# the rank of this process, and the device.\nfrom pippy.PipelineStage import PipelineStage\nstage = PipelineStage(pipe, rank, device)\n```\n\nWe can now run the pipeline by passing input to the first `PipelineStage`:\n```\n# Input data\nx = torch.randn(batch_size, in_dim, device=device)\n# Run the pipeline with input `x`. Divide the batch into 4 micro-batches\n# and run them in parallel on the pipeline\nif rank == 0:\n  stage(x)\nelif rank == world_size - 1:\n  output = stage()\nelse:\n  stage()\n```\n\nNote that since we split our model into three stages, we must run this script with three workers. For this example, we will use `torchrun` to run multiple processes within a single machine for demonstration purposes. We can collect up all of the code blocks above into a file named [example.py](https://github.com/pytorch/PiPPy/blob/main/examples/basic/example.py) and then run it with `torchrun` like so:\n```\ntorchrun --nproc_per_node=3 example.py\n\n```\n\n## License\n[](https://github.com/pytorch/PiPPy/#license)\nPiPPy is 3-clause BSD licensed, as found in the LICENSE file.\n## Citing PiPPy\n[](https://github.com/pytorch/PiPPy/#citing-pippy)\nIf you use PiPPy in your publication, please cite it by using the following BibTeX entry.\n```\n@Misc{pippy2022,\n author =    {James Reed, Pavel Belevich, Ke Wen, Howard Huang, Will Constable},\n title =    {PiPPy: Pipeline Parallelism for PyTorch},\n howpublished = {\\url{https://github.com/pytorch/PiPPy}},\n year =     {2022}\n}\n```\n\n## About\nPipeline Parallelism for PyTorch \n### Resources\n[ Readme ](https://github.com/pytorch/PiPPy/#readme-ov-file)\n### License\n[ BSD-3-Clause license ](https://github.com/pytorch/PiPPy/#BSD-3-Clause-1-ov-file)\n### Code of conduct\n[ Code of conduct ](https://github.com/pytorch/PiPPy/#coc-ov-file)\n[ Activity](https://github.com/pytorch/PiPPy/activity)\n[ Custom properties](https://github.com/pytorch/PiPPy/custom-properties)\n### Stars\n[ **760** stars](https://github.com/pytorch/PiPPy/stargazers)\n### Watchers\n[ **33** watching](https://github.com/pytorch/PiPPy/watchers)\n### Forks\n[ **87** forks](https://github.com/pytorch/PiPPy/forks)\n[ Report repository ](https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fpytorch%2FPiPPy&report=pytorch+%28user%29)\n##  [Releases](https://github.com/pytorch/PiPPy/releases)\n[ 4 tags ](https://github.com/pytorch/PiPPy/tags)\n##  [Packages 0](https://github.com/orgs/pytorch/packages?repo_name=PiPPy)\nNo packages published \n##  [Contributors 37](https://github.com/pytorch/PiPPy/graphs/contributors)\n[+ 23 contributors](https://github.com/pytorch/PiPPy/graphs/contributors)\n## Languages\n  * [ Python 98.7% ](https://github.com/pytorch/PiPPy/search?l=python)\n  * [ Shell 1.3% ](https://github.com/pytorch/PiPPy/search?l=shell)\n\n\n## Footer\n[ ](https://github.com \"GitHub\") © 2025 GitHub, Inc. \n### Footer navigation\n  * [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)\n  * [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)\n  * [Security](https://github.com/security)\n  * [Status](https://www.githubstatus.com/)\n  * [Docs](https://docs.github.com/)\n  * [Contact](https://support.github.com?tags=dotcom-footer)\n  * Manage cookies \n  * Do not share my personal information \n\n\nYou can’t perform that action at this time. \n",
    "content_quality_score": 0.6,
    "summary": null,
    "child_urls": [
        "https://github.com/pytorch/PiPPy/#start-of-content",
        "https://github.com/",
        "https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fpytorch%2FPiPPy%2F",
        "https://github.com/features/copilot",
        "https://github.com/features/security",
        "https://github.com/features/actions",
        "https://github.com/features/codespaces",
        "https://github.com/features/issues",
        "https://github.com/features/code-review",
        "https://github.com/features/discussions",
        "https://github.com/features/code-search",
        "https://github.com/features",
        "https://docs.github.com",
        "https://skills.github.com",
        "https://github.com/enterprise",
        "https://github.com/team",
        "https://github.com/enterprise/startups",
        "https://github.com/solutions/industry/nonprofits",
        "https://github.com/solutions/use-case/devsecops",
        "https://github.com/solutions/use-case/devops",
        "https://github.com/solutions/use-case/ci-cd",
        "https://github.com/solutions/use-case",
        "https://github.com/solutions/industry/healthcare",
        "https://github.com/solutions/industry/financial-services",
        "https://github.com/solutions/industry/manufacturing",
        "https://github.com/solutions/industry/government",
        "https://github.com/solutions/industry",
        "https://github.com/solutions",
        "https://github.com/resources/articles/ai",
        "https://github.com/resources/articles/devops",
        "https://github.com/resources/articles/security",
        "https://github.com/resources/articles/software-development",
        "https://github.com/resources/articles",
        "https://resources.github.com/learn/pathways",
        "https://resources.github.com",
        "https://github.com/resources/whitepapers",
        "https://github.com/customer-stories",
        "https://partner.github.com",
        "https://github.com/solutions/executive-insights",
        "https://github.com/sponsors",
        "https://github.com/readme",
        "https://github.com/topics",
        "https://github.com/trending",
        "https://github.com/collections",
        "https://github.com/enterprise/advanced-security",
        "https://github.com/features/copilot/copilot-business",
        "https://github.com/premium-support",
        "https://github.com/pricing",
        "https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax",
        "https://github.com/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=pytorch%2FPiPPy",
        "https://github.com/pytorch",
        "https://github.com/pytorch/PiPPy",
        "https://github.com/login?return_to=%2Fpytorch%2FPiPPy",
        "https://github.com/pytorch/PiPPy/blob/main/LICENSE",
        "https://github.com/pytorch/PiPPy/stargazers",
        "https://github.com/pytorch/PiPPy/forks",
        "https://github.com/pytorch/PiPPy/branches",
        "https://github.com/pytorch/PiPPy/tags",
        "https://github.com/pytorch/PiPPy/activity",
        "https://github.com/pytorch/PiPPy/issues",
        "https://github.com/pytorch/PiPPy/pulls",
        "https://github.com/pytorch/PiPPy/actions",
        "https://github.com/pytorch/PiPPy/projects",
        "https://github.com/pytorch/PiPPy/security",
        "https://github.com/pytorch/PiPPy/pulse",
        "https://github.com/pytorch/PiPPy/commits/main/",
        "https://github.com/pytorch/PiPPy/tree/main/.github/workflows",
        "https://github.com/pytorch/PiPPy/tree/main/binaries",
        "https://github.com/pytorch/PiPPy/tree/main/docs",
        "https://github.com/pytorch/PiPPy/tree/main/examples",
        "https://github.com/pytorch/PiPPy/tree/main/pippy",
        "https://github.com/pytorch/PiPPy/tree/main/test",
        "https://github.com/pytorch/PiPPy/blob/main/.coverage",
        "https://github.com/pytorch/PiPPy/blob/main/.flake8",
        "https://github.com/pytorch/PiPPy/blob/main/.gitignore",
        "https://github.com/pytorch/PiPPy/blob/main/.gitmodules",
        "https://github.com/pytorch/PiPPy/blob/main/ARCHITECTURE.md",
        "https://github.com/pytorch/PiPPy/blob/main/CITATION",
        "https://github.com/pytorch/PiPPy/blob/main/CODE_OF_CONDUCT.md",
        "https://github.com/pytorch/PiPPy/blob/main/CONTRIBUTING.md",
        "https://github.com/pytorch/PiPPy/blob/main/README.md",
        "https://github.com/pytorch/PiPPy/blob/main/REFERENCE.md",
        "https://github.com/pytorch/PiPPy/blob/main/check.sh",
        "https://github.com/pytorch/PiPPy/blob/main/format.sh",
        "https://github.com/pytorch/PiPPy/blob/main/pyproject.toml",
        "https://github.com/pytorch/PiPPy/blob/main/requirements.txt",
        "https://github.com/pytorch/PiPPy/blob/main/setup.py",
        "https://github.com/pytorch/PiPPy/blob/main/version.txt",
        "https://github.com/pytorch/PiPPy/",
        "https://github.com/pytorch/PiPPy/#pippy-pipeline-parallelism-for-pytorch",
        "https://github.com/pytorch/pytorch",
        "https://github.com/pytorch/pytorch/tree/main/torch/distributed/pipelining",
        "https://github.com/pytorch/PiPPy/blob/main/examples",
        "https://github.com/pytorch/PiPPy/#why-pippy",
        "https://github.com/pytorch/PiPPy/#install",
        "https://github.com/pytorch/PiPPy/#examples",
        "https://github.com/pytorch/PiPPy/#pippy-explained",
        "https://github.com/pytorch/PiPPy/#what-is-pippy",
        "https://github.com/pytorch/PiPPy/blob/main/examples/huggingface",
        "https://github.com/pytorch/PiPPy/blob/main/examples/huggingface/pippy_bert.py",
        "https://github.com/pytorch/PiPPy/blob/main/examples/huggingface/pippy_gpt2.py",
        "https://github.com/pytorch/PiPPy/blob/main/examples/huggingface/pippy_t5.py",
        "https://github.com/pytorch/PiPPy/blob/main/examples/llama",
        "https://github.com/pytorch/PiPPy/#splitting-a-model-with-pipe",
        "https://github.com/pytorch/PiPPy/blob/main/test/test_pipe.py",
        "https://github.com/pytorch/PiPPy/#using-pipelinestage-for-pipelined-execution",
        "https://github.com/pytorch/PiPPy/blob/main/examples/basic/example.py",
        "https://github.com/pytorch/PiPPy/#license",
        "https://github.com/pytorch/PiPPy/#citing-pippy",
        "https://github.com/pytorch/PiPPy/#readme-ov-file",
        "https://github.com/pytorch/PiPPy/#BSD-3-Clause-1-ov-file",
        "https://github.com/pytorch/PiPPy/#coc-ov-file",
        "https://github.com/pytorch/PiPPy/custom-properties",
        "https://github.com/pytorch/PiPPy/watchers",
        "https://github.com/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fpytorch%2FPiPPy&report=pytorch+%28user%29",
        "https://github.com/pytorch/PiPPy/releases",
        "https://github.com/orgs/pytorch/packages?repo_name=PiPPy",
        "https://github.com/pytorch/PiPPy/graphs/contributors",
        "https://github.com/pytorch/PiPPy/search?l=python",
        "https://github.com/pytorch/PiPPy/search?l=shell",
        "https://github.com",
        "https://docs.github.com/site-policy/github-terms/github-terms-of-service",
        "https://docs.github.com/site-policy/privacy-policies/github-privacy-statement",
        "https://github.com/security",
        "https://docs.github.com/",
        "https://support.github.com?tags=dotcom-footer",
        "https://github.blog",
        "https://pytorch.org/docs/main/distributed.pipelining.html",
        "https://www.deepspeed.ai/tutorials/pipeline/",
        "https://private-user-images.githubusercontent.com/6676466/317342803-c93e2fe7-1cd4-49a2-9fd8-231ec9905e0c.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDMzNTY5NDksIm5iZiI6MTc0MzM1NjY0OSwicGF0aCI6Ii82Njc2NDY2LzMxNzM0MjgwMy1jOTNlMmZlNy0xY2Q0LTQ5YTItOWZkOC0yMzFlYzk5MDVlMGMuanBnP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDMzMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAzMzBUMTc0NDA5WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9YmJjMDNiM2VkYjg1MjA4NDc2NGI5MjU4NGU5YzFkZGU5MWIyNjhiZDVkMzU4MTZlZGViZWJmZWIzZWQxNDAxYSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.pw63-NJW05X45xuRlPCf9Od86_n_wh6SDe7pbgn-xPA",
        "https://www.githubstatus.com/"
    ]
}